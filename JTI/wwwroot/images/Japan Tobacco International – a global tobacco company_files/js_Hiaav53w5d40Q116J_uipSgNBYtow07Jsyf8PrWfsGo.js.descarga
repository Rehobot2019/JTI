/*!
Chosen, a Select Box Enhancer for jQuery and Prototype
by Patrick Filler for Harvest, http://getharvest.com

Version 1.8.3
Full source at https://github.com/harvesthq/chosen
Copyright (c) 2011-2018 Harvest http://getharvest.com

MIT License, https://github.com/harvesthq/chosen/blob/master/LICENSE.md
This file is generated by `grunt build`, do not edit it by hand.
*/

(function() {
  var $, AbstractChosen, Chosen, SelectParser,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

  SelectParser = (function() {
    function SelectParser() {
      this.options_index = 0;
      this.parsed = [];
    }

    SelectParser.prototype.add_node = function(child) {
      if (child.nodeName.toUpperCase() === "OPTGROUP") {
        return this.add_group(child);
      } else {
        return this.add_option(child);
      }
    };

    SelectParser.prototype.add_group = function(group) {
      var group_position, i, len, option, ref, results1;
      group_position = this.parsed.length;
      this.parsed.push({
        array_index: group_position,
        group: true,
        label: group.label,
        title: group.title ? group.title : void 0,
        children: 0,
        disabled: group.disabled,
        classes: group.className
      });
      ref = group.childNodes;
      results1 = [];
      for (i = 0, len = ref.length; i < len; i++) {
        option = ref[i];
        results1.push(this.add_option(option, group_position, group.disabled));
      }
      return results1;
    };

    SelectParser.prototype.add_option = function(option, group_position, group_disabled) {
      if (option.nodeName.toUpperCase() === "OPTION") {
        if (option.text !== "") {
          if (group_position != null) {
            this.parsed[group_position].children += 1;
          }
          this.parsed.push({
            array_index: this.parsed.length,
            options_index: this.options_index,
            value: option.value,
            text: option.text,
            html: option.innerHTML,
            title: option.title ? option.title : void 0,
            selected: option.selected,
            disabled: group_disabled === true ? group_disabled : option.disabled,
            group_array_index: group_position,
            group_label: group_position != null ? this.parsed[group_position].label : null,
            classes: option.className,
            style: option.style.cssText
          });
        } else {
          this.parsed.push({
            array_index: this.parsed.length,
            options_index: this.options_index,
            empty: true
          });
        }
        return this.options_index += 1;
      }
    };

    return SelectParser;

  })();

  SelectParser.select_to_array = function(select) {
    var child, i, len, parser, ref;
    parser = new SelectParser();
    ref = select.childNodes;
    for (i = 0, len = ref.length; i < len; i++) {
      child = ref[i];
      parser.add_node(child);
    }
    return parser.parsed;
  };

  AbstractChosen = (function() {
    function AbstractChosen(form_field, options1) {
      this.form_field = form_field;
      this.options = options1 != null ? options1 : {};
      this.label_click_handler = bind(this.label_click_handler, this);
      if (!AbstractChosen.browser_is_supported()) {
        return;
      }
      this.is_multiple = this.form_field.multiple;
      this.set_default_text();
      this.set_default_values();
      this.setup();
      this.set_up_html();
      this.register_observers();
      this.on_ready();
    }

    AbstractChosen.prototype.set_default_values = function() {
      this.click_test_action = (function(_this) {
        return function(evt) {
          return _this.test_active_click(evt);
        };
      })(this);
      this.activate_action = (function(_this) {
        return function(evt) {
          return _this.activate_field(evt);
        };
      })(this);
      this.active_field = false;
      this.mouse_on_container = false;
      this.results_showing = false;
      this.result_highlighted = null;
      this.is_rtl = this.options.rtl || /\bchosen-rtl\b/.test(this.form_field.className);
      this.allow_single_deselect = (this.options.allow_single_deselect != null) && (this.form_field.options[0] != null) && this.form_field.options[0].text === "" ? this.options.allow_single_deselect : false;
      this.disable_search_threshold = this.options.disable_search_threshold || 0;
      this.disable_search = this.options.disable_search || false;
      this.enable_split_word_search = this.options.enable_split_word_search != null ? this.options.enable_split_word_search : true;
      this.group_search = this.options.group_search != null ? this.options.group_search : true;
      this.search_contains = this.options.search_contains || false;
      this.single_backstroke_delete = this.options.single_backstroke_delete != null ? this.options.single_backstroke_delete : true;
      this.max_selected_options = this.options.max_selected_options || Infinity;
      this.inherit_select_classes = this.options.inherit_select_classes || false;
      this.display_selected_options = this.options.display_selected_options != null ? this.options.display_selected_options : true;
      this.display_disabled_options = this.options.display_disabled_options != null ? this.options.display_disabled_options : true;
      this.include_group_label_in_selected = this.options.include_group_label_in_selected || false;
      this.max_shown_results = this.options.max_shown_results || Number.POSITIVE_INFINITY;
      this.case_sensitive_search = this.options.case_sensitive_search || false;
      return this.hide_results_on_select = this.options.hide_results_on_select != null ? this.options.hide_results_on_select : true;
    };

    AbstractChosen.prototype.set_default_text = function() {
      if (this.form_field.getAttribute("data-placeholder")) {
        this.default_text = this.form_field.getAttribute("data-placeholder");
      } else if (this.is_multiple) {
        this.default_text = this.options.placeholder_text_multiple || this.options.placeholder_text || AbstractChosen.default_multiple_text;
      } else {
        this.default_text = this.options.placeholder_text_single || this.options.placeholder_text || AbstractChosen.default_single_text;
      }
      this.default_text = this.escape_html(this.default_text);
      return this.results_none_found = this.form_field.getAttribute("data-no_results_text") || this.options.no_results_text || AbstractChosen.default_no_result_text;
    };

    AbstractChosen.prototype.choice_label = function(item) {
      if (this.include_group_label_in_selected && (item.group_label != null)) {
        return "<b class='group-name'>" + item.group_label + "</b>" + item.html;
      } else {
        return item.html;
      }
    };

    AbstractChosen.prototype.mouse_enter = function() {
      return this.mouse_on_container = true;
    };

    AbstractChosen.prototype.mouse_leave = function() {
      return this.mouse_on_container = false;
    };

    AbstractChosen.prototype.input_focus = function(evt) {
      if (this.is_multiple) {
        if (!this.active_field) {
          return setTimeout(((function(_this) {
            return function() {
              return _this.container_mousedown();
            };
          })(this)), 50);
        }
      } else {
        if (!this.active_field) {
          return this.activate_field();
        }
      }
    };

    AbstractChosen.prototype.input_blur = function(evt) {
      if (!this.mouse_on_container) {
        this.active_field = false;
        return setTimeout(((function(_this) {
          return function() {
            return _this.blur_test();
          };
        })(this)), 100);
      }
    };

    AbstractChosen.prototype.label_click_handler = function(evt) {
      if (this.is_multiple) {
        return this.container_mousedown(evt);
      } else {
        return this.activate_field();
      }
    };

    AbstractChosen.prototype.results_option_build = function(options) {
      var content, data, data_content, i, len, ref, shown_results;
      content = '';
      shown_results = 0;
      ref = this.results_data;
      for (i = 0, len = ref.length; i < len; i++) {
        data = ref[i];
        data_content = '';
        if (data.group) {
          data_content = this.result_add_group(data);
        } else {
          data_content = this.result_add_option(data);
        }
        if (data_content !== '') {
          shown_results++;
          content += data_content;
        }
        if (options != null ? options.first : void 0) {
          if (data.selected && this.is_multiple) {
            this.choice_build(data);
          } else if (data.selected && !this.is_multiple) {
            this.single_set_selected_text(this.choice_label(data));
          }
        }
        if (shown_results >= this.max_shown_results) {
          break;
        }
      }
      return content;
    };

    AbstractChosen.prototype.result_add_option = function(option) {
      var classes, option_el;
      if (!option.search_match) {
        return '';
      }
      if (!this.include_option_in_results(option)) {
        return '';
      }
      classes = [];
      if (!option.disabled && !(option.selected && this.is_multiple)) {
        classes.push("active-result");
      }
      if (option.disabled && !(option.selected && this.is_multiple)) {
        classes.push("disabled-result");
      }
      if (option.selected) {
        classes.push("result-selected");
      }
      if (option.group_array_index != null) {
        classes.push("group-option");
      }
      if (option.classes !== "") {
        classes.push(option.classes);
      }
      option_el = document.createElement("li");
      option_el.className = classes.join(" ");
      option_el.style.cssText = option.style;
      option_el.setAttribute("data-option-array-index", option.array_index);
      option_el.innerHTML = option.highlighted_html || option.html;
      if (option.title) {
        option_el.title = option.title;
      }
      return this.outerHTML(option_el);
    };

    AbstractChosen.prototype.result_add_group = function(group) {
      var classes, group_el;
      if (!(group.search_match || group.group_match)) {
        return '';
      }
      if (!(group.active_options > 0)) {
        return '';
      }
      classes = [];
      classes.push("group-result");
      if (group.classes) {
        classes.push(group.classes);
      }
      group_el = document.createElement("li");
      group_el.className = classes.join(" ");
      group_el.innerHTML = group.highlighted_html || this.escape_html(group.label);
      if (group.title) {
        group_el.title = group.title;
      }
      return this.outerHTML(group_el);
    };

    AbstractChosen.prototype.results_update_field = function() {
      this.set_default_text();
      if (!this.is_multiple) {
        this.results_reset_cleanup();
      }
      this.result_clear_highlight();
      this.results_build();
      if (this.results_showing) {
        return this.winnow_results();
      }
    };

    AbstractChosen.prototype.reset_single_select_options = function() {
      var i, len, ref, result, results1;
      ref = this.results_data;
      results1 = [];
      for (i = 0, len = ref.length; i < len; i++) {
        result = ref[i];
        if (result.selected) {
          results1.push(result.selected = false);
        } else {
          results1.push(void 0);
        }
      }
      return results1;
    };

    AbstractChosen.prototype.results_toggle = function() {
      if (this.results_showing) {
        return this.results_hide();
      } else {
        return this.results_show();
      }
    };

    AbstractChosen.prototype.results_search = function(evt) {
      if (this.results_showing) {
        return this.winnow_results();
      } else {
        return this.results_show();
      }
    };

    AbstractChosen.prototype.winnow_results = function() {
      var escapedQuery, fix, i, len, option, prefix, query, ref, regex, results, results_group, search_match, startpos, suffix, text;
      this.no_results_clear();
      results = 0;
      query = this.get_search_text();
      escapedQuery = query.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&");
      regex = this.get_search_regex(escapedQuery);
      ref = this.results_data;
      for (i = 0, len = ref.length; i < len; i++) {
        option = ref[i];
        option.search_match = false;
        results_group = null;
        search_match = null;
        option.highlighted_html = '';
        if (this.include_option_in_results(option)) {
          if (option.group) {
            option.group_match = false;
            option.active_options = 0;
          }
          if ((option.group_array_index != null) && this.results_data[option.group_array_index]) {
            results_group = this.results_data[option.group_array_index];
            if (results_group.active_options === 0 && results_group.search_match) {
              results += 1;
            }
            results_group.active_options += 1;
          }
          text = option.group ? option.label : option.text;
          if (!(option.group && !this.group_search)) {
            search_match = this.search_string_match(text, regex);
            option.search_match = search_match != null;
            if (option.search_match && !option.group) {
              results += 1;
            }
            if (option.search_match) {
              if (query.length) {
                startpos = search_match.index;
                prefix = text.slice(0, startpos);
                fix = text.slice(startpos, startpos + query.length);
                suffix = text.slice(startpos + query.length);
                option.highlighted_html = (this.escape_html(prefix)) + "<em>" + (this.escape_html(fix)) + "</em>" + (this.escape_html(suffix));
              }
              if (results_group != null) {
                results_group.group_match = true;
              }
            } else if ((option.group_array_index != null) && this.results_data[option.group_array_index].search_match) {
              option.search_match = true;
            }
          }
        }
      }
      this.result_clear_highlight();
      if (results < 1 && query.length) {
        this.update_results_content("");
        return this.no_results(query);
      } else {
        this.update_results_content(this.results_option_build());
        return this.winnow_results_set_highlight();
      }
    };

    AbstractChosen.prototype.get_search_regex = function(escaped_search_string) {
      var regex_flag, regex_string;
      regex_string = this.search_contains ? escaped_search_string : "(^|\\s|\\b)" + escaped_search_string + "[^\\s]*";
      if (!(this.enable_split_word_search || this.search_contains)) {
        regex_string = "^" + regex_string;
      }
      regex_flag = this.case_sensitive_search ? "" : "i";
      return new RegExp(regex_string, regex_flag);
    };

    AbstractChosen.prototype.search_string_match = function(search_string, regex) {
      var match;
      match = regex.exec(search_string);
      if (!this.search_contains && (match != null ? match[1] : void 0)) {
        match.index += 1;
      }
      return match;
    };

    AbstractChosen.prototype.choices_count = function() {
      var i, len, option, ref;
      if (this.selected_option_count != null) {
        return this.selected_option_count;
      }
      this.selected_option_count = 0;
      ref = this.form_field.options;
      for (i = 0, len = ref.length; i < len; i++) {
        option = ref[i];
        if (option.selected) {
          this.selected_option_count += 1;
        }
      }
      return this.selected_option_count;
    };

    AbstractChosen.prototype.choices_click = function(evt) {
      evt.preventDefault();
      this.activate_field();
      if (!(this.results_showing || this.is_disabled)) {
        return this.results_show();
      }
    };

    AbstractChosen.prototype.keydown_checker = function(evt) {
      var ref, stroke;
      stroke = (ref = evt.which) != null ? ref : evt.keyCode;
      this.search_field_scale();
      if (stroke !== 8 && this.pending_backstroke) {
        this.clear_backstroke();
      }
      switch (stroke) {
        case 8:
          this.backstroke_length = this.get_search_field_value().length;
          break;
        case 9:
          if (this.results_showing && !this.is_multiple) {
            this.result_select(evt);
          }
          this.mouse_on_container = false;
          break;
        case 13:
          if (this.results_showing) {
            evt.preventDefault();
          }
          break;
        case 27:
          if (this.results_showing) {
            evt.preventDefault();
          }
          break;
        case 32:
          if (this.disable_search) {
            evt.preventDefault();
          }
          break;
        case 38:
          evt.preventDefault();
          this.keyup_arrow();
          break;
        case 40:
          evt.preventDefault();
          this.keydown_arrow();
          break;
      }
    };

    AbstractChosen.prototype.keyup_checker = function(evt) {
      var ref, stroke;
      stroke = (ref = evt.which) != null ? ref : evt.keyCode;
      this.search_field_scale();
      switch (stroke) {
        case 8:
          if (this.is_multiple && this.backstroke_length < 1 && this.choices_count() > 0) {
            this.keydown_backstroke();
          } else if (!this.pending_backstroke) {
            this.result_clear_highlight();
            this.results_search();
          }
          break;
        case 13:
          evt.preventDefault();
          if (this.results_showing) {
            this.result_select(evt);
          }
          break;
        case 27:
          if (this.results_showing) {
            this.results_hide();
          }
          break;
        case 9:
        case 16:
        case 17:
        case 18:
        case 38:
        case 40:
        case 91:
          break;
        default:
          this.results_search();
          break;
      }
    };

    AbstractChosen.prototype.clipboard_event_checker = function(evt) {
      if (this.is_disabled) {
        return;
      }
      return setTimeout(((function(_this) {
        return function() {
          return _this.results_search();
        };
      })(this)), 50);
    };

    AbstractChosen.prototype.container_width = function() {
      if (this.options.width != null) {
        return this.options.width;
      } else {
        return this.form_field.offsetWidth + "px";
      }
    };

    AbstractChosen.prototype.include_option_in_results = function(option) {
      if (this.is_multiple && (!this.display_selected_options && option.selected)) {
        return false;
      }
      if (!this.display_disabled_options && option.disabled) {
        return false;
      }
      if (option.empty) {
        return false;
      }
      return true;
    };

    AbstractChosen.prototype.search_results_touchstart = function(evt) {
      this.touch_started = true;
      return this.search_results_mouseover(evt);
    };

    AbstractChosen.prototype.search_results_touchmove = function(evt) {
      this.touch_started = false;
      return this.search_results_mouseout(evt);
    };

    AbstractChosen.prototype.search_results_touchend = function(evt) {
      if (this.touch_started) {
        return this.search_results_mouseup(evt);
      }
    };

    AbstractChosen.prototype.outerHTML = function(element) {
      var tmp;
      if (element.outerHTML) {
        return element.outerHTML;
      }
      tmp = document.createElement("div");
      tmp.appendChild(element);
      return tmp.innerHTML;
    };

    AbstractChosen.prototype.get_single_html = function() {
      return "<a class=\"chosen-single chosen-default\">\n  <input class=\"chosen-search-input\" type=\"text\" autocomplete=\"off\" />\n  <span>" + this.default_text + "</span>\n  <div><b></b></div>\n</a>\n<div class=\"chosen-drop\">\n  <div class=\"chosen-search\">\n  </div>\n  <ul class=\"chosen-results\"></ul>\n</div>";
    };

    AbstractChosen.prototype.get_multi_html = function() {
      return "<ul class=\"chosen-choices\">\n  <li class=\"search-field\">\n    <input class=\"chosen-search-input\" type=\"text\" autocomplete=\"off\" value=\"" + this.default_text + "\" />\n  </li>\n</ul>\n<div class=\"chosen-drop\">\n  <ul class=\"chosen-results\"></ul>\n</div>";
    };

    AbstractChosen.prototype.get_no_results_html = function(terms) {
      return "<li class=\"no-results\">\n  " + this.results_none_found + " <span>" + (this.escape_html(terms)) + "</span>\n</li>";
    };

    AbstractChosen.browser_is_supported = function() {
      if ("Microsoft Internet Explorer" === window.navigator.appName) {
        return document.documentMode >= 8;
      }
      /*if (/iP(od|hone)/i.test(window.navigator.userAgent) || /IEMobile/i.test(window.navigator.userAgent) || /Windows Phone/i.test(window.navigator.userAgent) || /BlackBerry/i.test(window.navigator.userAgent) || /BB10/i.test(window.navigator.userAgent) || /Android.*Mobile/i.test(window.navigator.userAgent)) {
        return false;
      }*/
      return true;
    };

    AbstractChosen.default_multiple_text = "Select Some Options";

    AbstractChosen.default_single_text = "Select an Option";

    AbstractChosen.default_no_result_text = "No results match";

    return AbstractChosen;

  })();

  $ = jQuery;

  $.fn.extend({
    chosen: function(options) {
      if (!AbstractChosen.browser_is_supported()) {
        return this;
      }
      return this.each(function(input_field) {
        var $this, chosen;
        $this = $(this);
        chosen = $this.data('chosen');
        if (options === 'destroy') {
          if (chosen instanceof Chosen) {
            chosen.destroy();
          }
          return;
        }
        if (!(chosen instanceof Chosen)) {
          $this.data('chosen', new Chosen(this, options));
        }
      });
    }
  });

  Chosen = (function(superClass) {
    extend(Chosen, superClass);

    function Chosen() {
      return Chosen.__super__.constructor.apply(this, arguments);
    }

    Chosen.prototype.setup = function() {
      this.form_field_jq = $(this.form_field);
      return this.current_selectedIndex = this.form_field.selectedIndex;
    };

    Chosen.prototype.set_up_html = function() {
      var container_classes, container_props;
      container_classes = ["chosen-container"];
      container_classes.push("chosen-container-" + (this.is_multiple ? "multi" : "single"));
      if (this.inherit_select_classes && this.form_field.className) {
        container_classes.push(this.form_field.className);
      }
      if (this.is_rtl) {
        container_classes.push("chosen-rtl");
      }
      container_props = {
        'class': container_classes.join(' '),
        'title': this.form_field.title
      };
      if (this.form_field.id.length) {
        container_props.id = this.form_field.id.replace(/[^\w]/g, '_') + "_chosen";
      }
      this.container = $("<div />", container_props);
      this.container.width(this.container_width());
      if (this.is_multiple) {
        this.container.html(this.get_multi_html());
      } else {
        this.container.html(this.get_single_html());
      }
      this.form_field_jq.hide().after(this.container);
      this.dropdown = this.container.find('div.chosen-drop').first();
      this.search_field = this.container.find('input').first();
      this.search_results = this.container.find('ul.chosen-results').first();
      this.search_field_scale();
      this.search_no_results = this.container.find('li.no-results').first();
      if (this.is_multiple) {
        this.search_choices = this.container.find('ul.chosen-choices').first();
        this.search_container = this.container.find('li.search-field').first();
      } else {
        this.search_container = this.container.find('div.chosen-search').first();
        this.selected_item = this.container.find('.chosen-single').first();
      }
      this.results_build();
      this.set_tab_index();
      return this.set_label_behavior();
    };

    Chosen.prototype.on_ready = function() {
      return this.form_field_jq.trigger("chosen:ready", {
        chosen: this
      });
    };

    Chosen.prototype.register_observers = function() {
      this.container.on('touchstart.chosen', (function(_this) {
        return function(evt) {
          _this.container_mousedown(evt);
        };
      })(this));
      this.container.on('touchend.chosen', (function(_this) {
        return function(evt) {
          _this.container_mouseup(evt);
        };
      })(this));
      this.container.on('mousedown.chosen', (function(_this) {
        return function(evt) {
          _this.container_mousedown(evt);
        };
      })(this));
      this.container.on('mouseup.chosen', (function(_this) {
        return function(evt) {
          _this.container_mouseup(evt);
        };
      })(this));
      this.container.on('mouseenter.chosen', (function(_this) {
        return function(evt) {
          _this.mouse_enter(evt);
        };
      })(this));
      this.container.on('mouseleave.chosen', (function(_this) {
        return function(evt) {
          _this.mouse_leave(evt);
        };
      })(this));
      this.search_results.on('mouseup.chosen', (function(_this) {
        return function(evt) {
          _this.search_results_mouseup(evt);
        };
      })(this));
      this.search_results.on('mouseover.chosen', (function(_this) {
        return function(evt) {
          _this.search_results_mouseover(evt);
        };
      })(this));
      this.search_results.on('mouseout.chosen', (function(_this) {
        return function(evt) {
          _this.search_results_mouseout(evt);
        };
      })(this));
      this.search_results.on('mousewheel.chosen DOMMouseScroll.chosen', (function(_this) {
        return function(evt) {
          _this.search_results_mousewheel(evt);
        };
      })(this));
      this.search_results.on('touchstart.chosen', (function(_this) {
        return function(evt) {
          _this.search_results_touchstart(evt);
        };
      })(this));
      this.search_results.on('touchmove.chosen', (function(_this) {
        return function(evt) {
          _this.search_results_touchmove(evt);
        };
      })(this));
      this.search_results.on('touchend.chosen', (function(_this) {
        return function(evt) {
          _this.search_results_touchend(evt);
        };
      })(this));
      this.form_field_jq.on("chosen:updated.chosen", (function(_this) {
        return function(evt) {
          _this.results_update_field(evt);
        };
      })(this));
      this.form_field_jq.on("chosen:activate.chosen", (function(_this) {
        return function(evt) {
          _this.activate_field(evt);
        };
      })(this));
      this.form_field_jq.on("chosen:open.chosen", (function(_this) {
        return function(evt) {
          _this.container_mousedown(evt);
        };
      })(this));
      this.form_field_jq.on("chosen:close.chosen", (function(_this) {
        return function(evt) {
          _this.close_field(evt);
        };
      })(this));
      this.search_field.on('blur.chosen', (function(_this) {
        return function(evt) {
          _this.input_blur(evt);
        };
      })(this));
      this.search_field.on('keyup.chosen', (function(_this) {
        return function(evt) {
          _this.keyup_checker(evt);
        };
      })(this));
      this.search_field.on('keydown.chosen', (function(_this) {
        return function(evt) {
          _this.keydown_checker(evt);
        };
      })(this));
      this.search_field.on('focus.chosen', (function(_this) {
        return function(evt) {
          _this.input_focus(evt);
        };
      })(this));
      this.search_field.on('cut.chosen', (function(_this) {
        return function(evt) {
          _this.clipboard_event_checker(evt);
        };
      })(this));
      this.search_field.on('paste.chosen', (function(_this) {
        return function(evt) {
          _this.clipboard_event_checker(evt);
        };
      })(this));
      if (this.is_multiple) {
        return this.search_choices.on('click.chosen', (function(_this) {
          return function(evt) {
            _this.choices_click(evt);
          };
        })(this));
      } else {
        return this.container.on('click.chosen', function(evt) {
          evt.preventDefault();
        });
      }
    };

    Chosen.prototype.destroy = function() {
      $(this.container[0].ownerDocument).off('click.chosen', this.click_test_action);
      if (this.form_field_label.length > 0) {
        this.form_field_label.off('click.chosen');
      }
      if (this.search_field[0].tabIndex) {
        this.form_field_jq[0].tabIndex = this.search_field[0].tabIndex;
      }
      this.container.remove();
      this.form_field_jq.removeData('chosen');
      return this.form_field_jq.show();
    };

    Chosen.prototype.search_field_disabled = function() {
      this.is_disabled = this.form_field.disabled || this.form_field_jq.parents('fieldset').is(':disabled');
      this.container.toggleClass('chosen-disabled', this.is_disabled);
      this.search_field[0].disabled = this.is_disabled;
      if (!this.is_multiple) {
        this.selected_item.off('focus.chosen', this.activate_field);
      }
      if (this.is_disabled) {
        return this.close_field();
      } else if (!this.is_multiple) {
        return this.selected_item.on('focus.chosen', this.activate_field);
      }
    };

    Chosen.prototype.container_mousedown = function(evt) {
      var ref;
      if (this.is_disabled) {
        return;
      }
      if (evt && ((ref = evt.type) === 'mousedown' || ref === 'touchstart') && !this.results_showing) {
        evt.preventDefault();
      }
      if (!((evt != null) && ($(evt.target)).hasClass("search-choice-close"))) {
        if (!this.active_field) {
          if (this.is_multiple) {
            this.search_field.val("");
          }
          $(this.container[0].ownerDocument).on('click.chosen', this.click_test_action);
          this.results_show();
        } else if (!this.is_multiple && evt && (($(evt.target)[0] === this.selected_item[0]) || $(evt.target).parents("a.chosen-single").length)) {
          evt.preventDefault();
          this.results_toggle();
        }
        return this.activate_field();
      }
    };

    Chosen.prototype.container_mouseup = function(evt) {
      if (evt.target.nodeName === "ABBR" && !this.is_disabled) {
        return this.results_reset(evt);
      }
    };

    Chosen.prototype.search_results_mousewheel = function(evt) {
      var delta;
      if (evt.originalEvent) {
        delta = evt.originalEvent.deltaY || -evt.originalEvent.wheelDelta || evt.originalEvent.detail;
      }
      if (delta != null) {
        evt.preventDefault();
        if (evt.type === 'DOMMouseScroll') {
          delta = delta * 40;
        }
        return this.search_results.scrollTop(delta + this.search_results.scrollTop());
      }
    };

    Chosen.prototype.blur_test = function(evt) {
      if (!this.active_field && this.container.hasClass("chosen-container-active")) {
        return this.close_field();
      }
    };

    Chosen.prototype.close_field = function() {
      $(this.container[0].ownerDocument).off("click.chosen", this.click_test_action);
      this.active_field = false;
      this.results_hide();
      this.container.removeClass("chosen-container-active");
      this.clear_backstroke();
      this.show_search_field_default();
      this.search_field_scale();
      return this.search_field.blur();
    };

    Chosen.prototype.activate_field = function() {
      if (this.is_disabled) {
        return;
      }
      this.container.addClass("chosen-container-active");
      this.active_field = true;
      this.search_field.val(this.search_field.val());
      return this.search_field.focus();
    };

    Chosen.prototype.test_active_click = function(evt) {
      var active_container;
      active_container = $(evt.target).closest('.chosen-container');
      if (active_container.length && this.container[0] === active_container[0]) {
        return this.active_field = true;
      } else {
        return this.close_field();
      }
    };

    Chosen.prototype.results_build = function() {
      this.parsing = true;
      this.selected_option_count = null;
      this.results_data = SelectParser.select_to_array(this.form_field);
      if (this.is_multiple) {
        this.search_choices.find("li.search-choice").remove();
      } else if (!this.is_multiple) {
        this.single_set_selected_text();
        if (this.disable_search || this.form_field.options.length <= this.disable_search_threshold) {
          this.search_field[0].readOnly = true;
          this.container.addClass("chosen-container-single-nosearch");
        } else {
          this.search_field[0].readOnly = false;
          this.container.removeClass("chosen-container-single-nosearch");
        }
      }
      this.update_results_content(this.results_option_build({
        first: true
      }));
      this.search_field_disabled();
      this.show_search_field_default();
      this.search_field_scale();
      return this.parsing = false;
    };

    Chosen.prototype.result_do_highlight = function(el) {
      var high_bottom, high_top, maxHeight, visible_bottom, visible_top;
      if (el.length) {
        this.result_clear_highlight();
        this.result_highlight = el;
        this.result_highlight.addClass("highlighted");
        maxHeight = parseInt(this.search_results.css("maxHeight"), 10);
        visible_top = this.search_results.scrollTop();
        visible_bottom = maxHeight + visible_top;
        high_top = this.result_highlight.position().top + this.search_results.scrollTop();
        high_bottom = high_top + this.result_highlight.outerHeight();
        if (high_bottom >= visible_bottom) {
          return this.search_results.scrollTop((high_bottom - maxHeight) > 0 ? high_bottom - maxHeight : 0);
        } else if (high_top < visible_top) {
          return this.search_results.scrollTop(high_top);
        }
      }
    };

    Chosen.prototype.result_clear_highlight = function() {
      if (this.result_highlight) {
        this.result_highlight.removeClass("highlighted");
      }
      return this.result_highlight = null;
    };

    Chosen.prototype.results_show = function() {
      if (this.is_multiple && this.max_selected_options <= this.choices_count()) {
        this.form_field_jq.trigger("chosen:maxselected", {
          chosen: this
        });
        return false;
      }
      if (!this.is_multiple) {
        this.search_container.append(this.search_field);
      }
      this.container.addClass("chosen-with-drop");
      this.results_showing = true;
      this.search_field.focus();
      this.search_field.val(this.get_search_field_value());
      this.winnow_results();
      return this.form_field_jq.trigger("chosen:showing_dropdown", {
        chosen: this
      });
    };

    Chosen.prototype.update_results_content = function(content) {
      return this.search_results.html(content);
    };

    Chosen.prototype.results_hide = function() {
      if (this.results_showing) {
        this.result_clear_highlight();
        if (!this.is_multiple) {
          this.selected_item.prepend(this.search_field);
          this.search_field.focus();
        }
        this.container.removeClass("chosen-with-drop");
        this.form_field_jq.trigger("chosen:hiding_dropdown", {
          chosen: this
        });
      }
      return this.results_showing = false;
    };

    Chosen.prototype.set_tab_index = function(el) {
      var ti;
      if (this.form_field.tabIndex) {
        ti = this.form_field.tabIndex;
        this.form_field.tabIndex = -1;
        return this.search_field[0].tabIndex = ti;
      }
    };

    Chosen.prototype.set_label_behavior = function() {
      this.form_field_label = this.form_field_jq.parents("label");
      if (!this.form_field_label.length && this.form_field.id.length) {
        this.form_field_label = $("label[for='" + this.form_field.id + "']");
      }
      if (this.form_field_label.length > 0) {
        return this.form_field_label.on('click.chosen', this.label_click_handler);
      }
    };

    Chosen.prototype.show_search_field_default = function() {
      if (this.is_multiple && this.choices_count() < 1 && !this.active_field) {
        this.search_field.val(this.default_text);
        return this.search_field.addClass("default");
      } else {
        this.search_field.val("");
        return this.search_field.removeClass("default");
      }
    };

    Chosen.prototype.search_results_mouseup = function(evt) {
      var target;
      target = $(evt.target).hasClass("active-result") ? $(evt.target) : $(evt.target).parents(".active-result").first();
      if (target.length) {
        this.result_highlight = target;
        this.result_select(evt);
        return this.search_field.focus();
      }
    };

    Chosen.prototype.search_results_mouseover = function(evt) {
      var target;
      target = $(evt.target).hasClass("active-result") ? $(evt.target) : $(evt.target).parents(".active-result").first();
      if (target) {
        return this.result_do_highlight(target);
      }
    };

    Chosen.prototype.search_results_mouseout = function(evt) {
      if ($(evt.target).hasClass("active-result") || $(evt.target).parents('.active-result').first()) {
        return this.result_clear_highlight();
      }
    };

    Chosen.prototype.choice_build = function(item) {
      var choice, close_link;
      choice = $('<li />', {
        "class": "search-choice"
      }).html("<span>" + (this.choice_label(item)) + "</span>");
      if (item.disabled) {
        choice.addClass('search-choice-disabled');
      } else {
        close_link = $('<a />', {
          "class": 'search-choice-close',
          'data-option-array-index': item.array_index
        });
        close_link.on('click.chosen', (function(_this) {
          return function(evt) {
            return _this.choice_destroy_link_click(evt);
          };
        })(this));
        choice.append(close_link);
      }
      return this.search_container.before(choice);
    };

    Chosen.prototype.choice_destroy_link_click = function(evt) {
      evt.preventDefault();
      evt.stopPropagation();
      if (!this.is_disabled) {
        return this.choice_destroy($(evt.target));
      }
    };

    Chosen.prototype.choice_destroy = function(link) {
      if (this.result_deselect(link[0].getAttribute("data-option-array-index"))) {
        if (this.active_field) {
          this.search_field.focus();
        } else {
          this.show_search_field_default();
        }
        if (this.is_multiple && this.choices_count() > 0 && this.get_search_field_value().length < 1) {
          this.results_hide();
        }
        link.parents('li').first().remove();
        return this.search_field_scale();
      }
    };

    Chosen.prototype.results_reset = function() {
      this.reset_single_select_options();
      this.form_field.options[0].selected = true;
      this.single_set_selected_text();
      this.show_search_field_default();
      this.results_reset_cleanup();
      this.trigger_form_field_change();
      if (this.active_field) {
        return this.results_hide();
      }
    };

    Chosen.prototype.results_reset_cleanup = function() {
      this.current_selectedIndex = this.form_field.selectedIndex;
      return this.selected_item.find("abbr").remove();
    };

    Chosen.prototype.result_select = function(evt) {
      var high, item;
      if (this.result_highlight) {
        high = this.result_highlight;
        this.result_clear_highlight();
        if (this.is_multiple && this.max_selected_options <= this.choices_count()) {
          this.form_field_jq.trigger("chosen:maxselected", {
            chosen: this
          });
          return false;
        }
        if (this.is_multiple) {
          high.removeClass("active-result");
        } else {
          this.reset_single_select_options();
        }
        high.addClass("result-selected");
        item = this.results_data[high[0].getAttribute("data-option-array-index")];
        item.selected = true;
        this.form_field.options[item.options_index].selected = true;
        this.selected_option_count = null;
        this.search_field.val("");
        if (this.is_multiple) {
          this.choice_build(item);
        } else {
          this.single_set_selected_text(this.choice_label(item));
        }
        if (this.is_multiple && (!this.hide_results_on_select || (evt.metaKey || evt.ctrlKey))) {
          this.winnow_results();
        } else {
          this.results_hide();
          this.show_search_field_default();
        }
        if (this.is_multiple || this.form_field.selectedIndex !== this.current_selectedIndex) {
          this.trigger_form_field_change({
            selected: this.form_field.options[item.options_index].value
          });
        }
        this.current_selectedIndex = this.form_field.selectedIndex;
        evt.preventDefault();
        return this.search_field_scale();
      }
    };

    Chosen.prototype.single_set_selected_text = function(text) {
      if (text == null) {
        text = this.default_text;
      }
      if (text === this.default_text) {
        this.selected_item.addClass("chosen-default");
      } else {
        this.single_deselect_control_build();
        this.selected_item.removeClass("chosen-default");
      }
      return this.selected_item.find("span").html(text);
    };

    Chosen.prototype.result_deselect = function(pos) {
      var result_data;
      result_data = this.results_data[pos];
      if (!this.form_field.options[result_data.options_index].disabled) {
        result_data.selected = false;
        this.form_field.options[result_data.options_index].selected = false;
        this.selected_option_count = null;
        this.result_clear_highlight();
        if (this.results_showing) {
          this.winnow_results();
        }
        this.trigger_form_field_change({
          deselected: this.form_field.options[result_data.options_index].value
        });
        this.search_field_scale();
        return true;
      } else {
        return false;
      }
    };

    Chosen.prototype.single_deselect_control_build = function() {
      if (!this.allow_single_deselect) {
        return;
      }
      if (!this.selected_item.find("abbr").length) {
        this.selected_item.find("span").first().after("<abbr class=\"search-choice-close\"></abbr>");
      }
      return this.selected_item.addClass("chosen-single-with-deselect");
    };

    Chosen.prototype.get_search_field_value = function() {
      return this.search_field.val();
    };

    Chosen.prototype.get_search_text = function() {
      return $.trim(this.get_search_field_value());
    };

    Chosen.prototype.escape_html = function(text) {
      return $('<div/>').text(text).html();
    };

    Chosen.prototype.winnow_results_set_highlight = function() {
      var do_high, selected_results;
      selected_results = !this.is_multiple ? this.search_results.find(".result-selected.active-result") : [];
      do_high = selected_results.length ? selected_results.first() : this.search_results.find(".active-result").first();
      if (do_high != null) {
        return this.result_do_highlight(do_high);
      }
    };

    Chosen.prototype.no_results = function(terms) {
      var no_results_html;
      no_results_html = this.get_no_results_html(terms);
      this.search_results.append(no_results_html);
      return this.form_field_jq.trigger("chosen:no_results", {
        chosen: this
      });
    };

    Chosen.prototype.no_results_clear = function() {
      return this.search_results.find(".no-results").remove();
    };

    Chosen.prototype.keydown_arrow = function() {
      var next_sib;
      if (this.results_showing && this.result_highlight) {
        next_sib = this.result_highlight.nextAll("li.active-result").first();
        if (next_sib) {
          return this.result_do_highlight(next_sib);
        }
      } else {
        return this.results_show();
      }
    };

    Chosen.prototype.keyup_arrow = function() {
      var prev_sibs;
      if (!this.results_showing && !this.is_multiple) {
        return this.results_show();
      } else if (this.result_highlight) {
        prev_sibs = this.result_highlight.prevAll("li.active-result");
        if (prev_sibs.length) {
          return this.result_do_highlight(prev_sibs.first());
        } else {
          if (this.choices_count() > 0) {
            this.results_hide();
          }
          return this.result_clear_highlight();
        }
      }
    };

    Chosen.prototype.keydown_backstroke = function() {
      var next_available_destroy;
      if (this.pending_backstroke) {
        this.choice_destroy(this.pending_backstroke.find("a").first());
        return this.clear_backstroke();
      } else {
        next_available_destroy = this.search_container.siblings("li.search-choice").last();
        if (next_available_destroy.length && !next_available_destroy.hasClass("search-choice-disabled")) {
          this.pending_backstroke = next_available_destroy;
          if (this.single_backstroke_delete) {
            return this.keydown_backstroke();
          } else {
            return this.pending_backstroke.addClass("search-choice-focus");
          }
        }
      }
    };

    Chosen.prototype.clear_backstroke = function() {
      if (this.pending_backstroke) {
        this.pending_backstroke.removeClass("search-choice-focus");
      }
      return this.pending_backstroke = null;
    };

    Chosen.prototype.search_field_scale = function() {
      var div, i, len, style, style_block, styles, width;
      if (!this.is_multiple) {
        return;
      }
      style_block = {
        position: 'absolute',
        left: '-1000px',
        top: '-1000px',
        display: 'none',
        whiteSpace: 'pre'
      };
      styles = ['fontSize', 'fontStyle', 'fontWeight', 'fontFamily', 'lineHeight', 'textTransform', 'letterSpacing'];
      for (i = 0, len = styles.length; i < len; i++) {
        style = styles[i];
        style_block[style] = this.search_field.css(style);
      }
      div = $('<div />').css(style_block);
      div.text(this.get_search_field_value());
      $('body').append(div);
      width = div.width() + 25;
      div.remove();
      if (this.container.is(':visible')) {
        width = Math.min(this.container.outerWidth() - 10, width);
      }
      return this.search_field.width(width);
    };

    Chosen.prototype.trigger_form_field_change = function(extra) {
      this.form_field_jq.trigger("input", extra);
      return this.form_field_jq.trigger("change", extra);
    };

    return Chosen;

  })(AbstractChosen);

}).call(this);
;
var newsWrapWhereIsotope;
/**
 * @file
 * Handle the form field behaviors.
 */
(function ($) {
    Drupal.behaviors.campaign_styling = {
        attach: function (context, settings) {
            if(jQuery(".page-node-type-perspective-campaing").length > 0) {
               twittersliderfn();
            }
            if (jQuery('html').hasClass('jsdisabled')) {
                jQuery('html').removeClass('jsdisabled');
                jQuery('html').addClass('jsenabled');
            }
            if (jQuery('body').hasClass('jsdisabled')) {
                jQuery('body').removeClass('jsdisabled');
                jQuery('body').addClass('jsenabled');
            }
            

            $.each(['fadeIn', 'fadeOut'], function (i, ev) {
                var el = $.fn[ev];
                $.fn[ev] = function () {
                  this.trigger(ev);
                  return el.apply(this, arguments);
                };
            });
            
            $("#mid-solr-search-form").attr('action', '/');
            
            var lang = 'en',
                baseUrl = '/',
                pathPrefix = 'en/';
            var previousCountry;

            if (typeof drupalSettings !== "undefined") {
                lang = drupalSettings.language;
                baseUrl = drupalSettings.baseUrl;
               // pathPrefix = drupalSettings.path.pathPrefix;
            }
            if(sessionStorage.getItem("countryChange") == "changed" && sessionStorage.getItem("countryChangeURL") == window.location.href) {
                sessionStorage.setItem("countryChange", "");
                sessionStorage.setItem("countryChangeURL", "");
                if(!jQuery(".block-views-blockperspective-list-block-1").length > 0)
                {
                    window.location.reload();
                }
            }
                

            $("#localization-menu-form select.countryDropdownOptions").chosen({
                disable_search_threshold: 10,
                no_results_text: "No result found",
                placeholder_text_single: "Select country",
                width: "100%"
            });
            
            $("#localization-menu-form select#edit-language").chosen({
                disable_search_threshold: 2,
                no_results_text: "No result found",
                placeholder_text_single: "Select language",
                width: "100%"
            });
            if($("#localization-menu-form select.langaugeDropdownOptions").hasClass("disable-dropdown")) {
                $("#localization-menu-form .form-item-language").hide();
            }
            $("#localization-menu-form select.countryDropdownOptions").unbind().on('change', function(evt, params) {
                changeOfCountrytoChangeLanguage(evt, params);
            });
            $("#localization-menu-form select#edit-language").unbind().on('change', function(evt, params) {
                changeOfLanguagetoChangeContent(evt, params);
            });

            
            /*=======================================================*
            *==========Starts:: Langauge URLS changes================*
            *========================================================*/ 
/*            if(lang != 'en') {
                //All megamenu links except external links
                if($('#block-mainmegamenu').length > 0) {
                    $('#block-mainmegamenu a').each(function(){
                        if(!(link_is_external(this))) {
                            if($(this).attr('href').indexOf("#") == -1 && (!$(this).attr('href').match("^mailto:")) && (!$(this).attr('href').match("^tel:"))) {
                                currentHref = $(this).attr('href');
                                currentUpdatedHref = currentHref.replace(/\//g, '--');
                                var getURLAlisalCall = "/megamenuChanges/"+"url"+currentUpdatedHref;
                                var _this = this;
                                if(currentHref) {
                                    $.ajax({
                                        type: "POST",
                                        url: getURLAlisalCall,
                                        data: currentUpdatedHref,
                                        func: 'neglectCMegaMenuUrlAjax',
                                        success: function(data){
                                            $(_this).attr('href', data);
                                        }
                                    });
                                }
                            }
                        }
                    });
                }
                //All footer links except external links
                if($('footer').length > 0) {
                    $('footer a').each(function(){
                        if(!(link_is_external(this))) {
                            if($(this).attr('href').indexOf("#") == -1 && (!$(this).attr('href').match("^mailto:")) && (!$(this).attr('href').match("^tel:"))) {
                                currentHref = $(this).attr('href');
                                currentUpdatedHref = currentHref.replace(/\//g, '--');
                                var getURLAlisalCall = "/megamenuChanges/"+"url"+currentUpdatedHref;
                                var _this = this;
                                if(currentHref) {
                                    $.ajax({
                                        type: "POST",
                                        url: getURLAlisalCall,
                                        data: currentUpdatedHref,
                                        func: 'neglectCMegaMenuUrlAjax',
                                        success: function(data){
                                            $(_this).attr('href', data);
                                        }
                                    });
                                }
                            }
                        }
                    });
                }
            }*/

            /*=======================================================*
            *======Starts:: Newsletter for all the country pages===*
            *========================================================*/ 
             if($(".page-node-type-country .view-id-country_additional_news .homenewsandsocialSection .newsitem").length > 0 ) { 
                $('.page-node-type-country .view-id-country_additional_news  ul.pagination li.pager__item a').click(function(){//)on('click', function (e) {
                   
                    $('body').addClass("loaderon");
                    $('.loaderbtn').css('display','block');
                    $(document).ajaxStop(function() {
                        $('.loaderbtn').css('display','none');
                        $('body').removeClass("loaderon");
                    });
                });
            }
            /*=======================================================*
            *=====Ends:: Newsletter for all the country pages======*
            *========================================================*/ 
            /*=======================================================*
            *==========Ends:: Langauge URLS changes================*
            *========================================================*/ 
            if($("#views-exposed-form-news-releases-block-2").length > 0 ) { 
                $('.newslandingSection ul.pagination li.pager__item a').click(function(){//)on('click', function (e) {
                	scrollFlag = 1;
                    $('body').addClass("loaderon");
                    $('.loaderbtn').css('display','block');
                    $(document).ajaxStop(function() {
                        $('.loaderbtn').css('display','none');
                        $('body').removeClass("loaderon");
                    });
                });
                $('.newslandingSection select').on('change', function (e) {
                    $(document).ajaxStart(function() {
                        $('body').addClass("loaderon");
                        $('.loaderbtn').css('display','block');
                    });

                    $(document).ajaxStop(function() {
                        $('.loaderbtn').css('display','none');
                        $('body').removeClass("loaderon");
                    });
                });
            }

            if($("#block-views-block-perspective-list-block-1").length > 0 ) { 
                $('body').addClass("page-type-perspective");
                $('select.campaignSelector').on('change', function (e) {
                    var campaignoptionSelected = $("option:selected", this);
                    var campaignvalueSelected = this.value;
                    changePerspectiveHeader(campaignvalueSelected);
                    $('.loaderbtn').css('display','block');
                    $('body').addClass("loaderon");
                });
                
                if(jQuery(".videoPlayer2").length>0){      
                   jQuery(".videoPlayer2").InvPlayer();
                }

                $(document).ajaxStart(function(event) {
                    if(sessionStorage.getItem("countryChangeAjax") == "views-started") {
                        sessionStorage.setItem("countryChangeAjax", "views-stopped");
                    } else {
                        $('body').addClass("loaderon");
                        $('.loaderbtn').css('display','block');
                    }
                });

                $(document).ajaxStop(function() {
                    $('.loaderbtn').css('display','none');
                    $('body').removeClass("loaderon");
                });

                $("form#product-feedback-form").on("reset",function(){
                    jQuery('form#product-feedback-form .form-item-dutyfree').hide();
                });
            }

            if ($(".bodcontainer").length > 0) {
                $(document).ajaxStart(function() {
                    $('body').addClass("loaderon");
                    $('.loaderbtn').css('display','block');
                });

                $(document).ajaxStop(function() {
                    $('.loaderbtn').css('display','none');
                    $('body').removeClass("loaderon");
                });
            }

            //Duty free checkbox
            if(jQuery("form#product-feedback-form").length > 0 ) {                
                jQuery('form#product-feedback-form .form-item-dutyfree').hide();
                jQuery('form#product-feedback-form select#edit-country--2,form#product-feedback-form select#edit-country--3').on('change', function (e) {
                    var countryOptionSelected = jQuery("option:selected", this);
                    var countryvalueSelected = this.value.split('--');
                    //GB is removed from below array
                    var countryArray = [ "AD", "AF", "AR", "CA", "CH", "CN", "CY", "DE", "DK", "DZ", "ES", "D5", "FR", "HK", "HU", "ID", "IE", "IL", "IN", "IQ", "IT", "D9", "JP", "KE", "KR", "B9", "MO", "MU", "MY", "NL", "NO", "PH", "A6", "RU", "TH", "TR", "TW", "US", "UY", "VN", "ZA", "ZW", "DJ" ];
                    if(jQuery.inArray(countryvalueSelected[0],countryArray) != -1 ){
                        $('form#product-feedback-form .form-item-dutyfree').show();
                    } else {
                        $('form#product-feedback-form .form-item-dutyfree').hide();
                    }
                });
            }
            //check dutyfree
            function dutyCheck(e){
               
               
            }
            //Perspective Datepicker
            jQuery(".form-item-story-dates select").on("change", function(event){
                if(jQuery(this).val() == "All")
                {
                    jQuery("input[data-drupal-selector='edit-field-filter-story-date-value-1']").val("");
                }
                else {
                    jQuery("input[data-drupal-selector='edit-field-filter-story-date-value-1']").val("-"+jQuery(this).val()+" "+"month");
                }
            });

            if(jQuery(".videoPlayer5").length>0){
                jQuery(".videoPlayer5").each(function() {                   
                  jQuery(this).InvPlayer();
                });
            }

            //Tag toggle code
            var _this = "select[name='field_story_type_target_id']";
            
            if($("select[data-drupal-selector='edit-field-story-type-target-id']").val() == "All" && jQuery(".form-checkboxes input.form-checkbox:checked").length>0){

                jQuery(".view-id-perspective_list .form-type-checkbox").show();
            }
            else {
                jQuery(".view-id-perspective_list .form-type-checkbox").hide();
            }

            if(jQuery("select[data-drupal-selector='edit-field-type-value']").length > 0)
            {
                //reset select list before unload for back button
                window.onbeforeunload = function() {
                    $("select[data-drupal-selector='edit-field-type-value']").val("All");
                    $("select[data-drupal-selector='edit-story-dates']").val("All");
                    $("select[data-drupal-selector='edit-field-story-type-target-id']").val("All").change();
                    $('select').niceSelect('update');
                }
            }
            
            //Check for childs only if select catagory has some value.
            if(jQuery(_this).val() != "All")
            {
                jQuery(".child__tags").each(function(index){
                    parentNodes = jQuery(this).data("parent") + '';
                    parentNodesArray = parentNodes.split(',');
                    if(parentNodesArray.indexOf(jQuery(_this).val()) > -1)
                    {
                        jQuery(this).parents("div.form-type-checkbox").show();
                    }
                    else{
                        jQuery(this).prev(".form-checkbox").prop('checked', false);
                    }
                });
            }

            //Category filter on change
            jQuery("select[data-drupal-selector='edit-field-story-type-target-id']").on("change",function(){
                if($(this).val() == "All")
                {
                    jQuery(".child__tags").each(function(index){
                        jQuery(this).prev(".form-checkbox").prop('checked', false);
                    });
                }
            });

            if($("#views-exposed-form-perspective-list-block-1").length > 0)
            {
                //Ajax handler our-view filter
                $(document).ajaxStop(function() {
                    if(sessionStorage.getItem("eventgridorlist")) {
                        if(sessionStorage.getItem("eventgridorlist") == "grid") {
                            jQuery('.perspectiveSection .view-header .gridList span').removeClass('active');
                            jQuery(".perspectiveSection .view-header .gridList .gridIcon").addClass('active');
                            jQuery('.perspectiveSection .gridview').fadeIn();
                            jQuery('.perspectiveSection .listview').fadeOut();
                        } else {
                            jQuery('.perspectiveSection .view-header .gridList span').removeClass('active');
                            jQuery(".perspectiveSection .view-header .gridList .listIcon").addClass('active');
                            jQuery('.perspectiveSection .listview').fadeIn();
                            jQuery('.perspectiveSection .gridview').fadeOut();
                        }
                    } else {
                        //Active grid
                        sessionStorage.eventgridorlist = "grid";
                        jQuery('.perspectiveSection .view-header .gridList span').removeClass('active');
                        jQuery(".perspectiveSection .view-header .gridList .gridIcon").addClass('active');
                        jQuery('.perspectiveSection .gridview').fadeIn();
                        jQuery('.perspectiveSection .listview').fadeOut();
                    }
                    setEqualHeight_CommonClass(".perspectiveitemWrap");
                });
            }
            
            //Old date picker
            /*jQuery(".form-item-field-filter-story-date-value").addClass("hiddenDatePicker");
            jQuery(".form-item-field-filter-story-date-value-1 input").datepicker({
                showOn: "button",
                buttonText: "Choose",
                changeMonth: true,
                changeYear: true,
            });
            jQuery(".form-item-field-filter-story-date-value input").datepicker({
                showOn: "button",
                showButtonPanel: true,
                closeText: "Ok",
                buttonText: "Choose",
                changeMonth: true,
                changeYear: true,
                dateFormat: 'MM yy',
                onClose: function(dateText, inst) { 
                    jQuery(this).datepicker('setDate', new Date(inst.selectedYear, inst.selectedMonth, 1));
                    var monthDays = daysInMonth(inst.selectedMonth,inst.selectedYear);
                    jQuery(".form-item-field-filter-story-date-value-1 input").datepicker('setDate', new Date(inst.selectedYear, inst.selectedMonth, monthDays));
                    $(document).ajaxStart(function() {
                        $('body').addClass("loaderon");
                        $('.loaderbtn').css('display','block');
                    });             
                    $("#views-exposed-form-perspective-list-block-1 .form-submit").trigger("click");
                    
                    $(document).ajaxStop(function() {
                        if(sessionStorage.getItem("eventgridorlist")) {
                            if(sessionStorage.getItem("eventgridorlist") == "grid") {
                                jQuery('.perspectiveSection .view-header .gridList span').removeClass('active');
                                jQuery(".perspectiveSection .view-header .gridList .gridIcon").addClass('active');
                                jQuery('.perspectiveSection .gridview').fadeIn();
                                jQuery('.perspectiveSection .listview').fadeOut();
                            } else {
                                jQuery('.perspectiveSection .view-header .gridList span').removeClass('active');
                                jQuery(".perspectiveSection .view-header .gridList .listIcon").addClass('active');
                                jQuery('.perspectiveSection .listview').fadeIn();
                                jQuery('.perspectiveSection .gridview').fadeOut();
                            }
                        } else {
                            //Active grid
                            sessionStorage.eventgridorlist = "grid";
                            jQuery('.perspectiveSection .view-header .gridList span').removeClass('active');
                            jQuery(".perspectiveSection .view-header .gridList .gridIcon").addClass('active');
                            jQuery('.perspectiveSection .gridview').fadeIn();
                            jQuery('.perspectiveSection .listview').fadeOut();
                        }
                        jQuery('.loaderbtn').css('display','none');
                        $('body').removeClass("loaderon");
                    });
                }
            });*/

            //Country Infomation AJAX Functionality
            if($(".region-country-tab").length > 0 ) {
                $('.view-region-country-tab .regionCountry').click(function (e) {
                    e.preventDefault();
                    getCountryInfromation($(this).attr("countryid"));
                    $('.view-region-country-tab .regionCountry').removeClass('active');
                    $(this).addClass('active');
                    $('.loaderbtn').css('display','block');
                    $('body').addClass("loaderon");
                });
            }
            
            //Code to get active URL's on location bar
            jQuery(document).on("click", ".view-region-country-tab a.regionCountry", function(e){
                e.preventDefault();
                history.replaceState({}, jQuery(this).attr("countrytitle"), jQuery(this).data("location"));
                ga('send', 'pageview', location.pathname);

                jQuery(".icons-facebook-icon").attr("href","https://www.facebook.com/sharer.php?u="+window.location.href);
                jQuery(".icons-email-icon").attr("href","mailto:?subject=Japan%20Tobacco%20International%20–"+ jQuery(this).attr("countrytitle") + "&body=I thought this page might interest you:"+ window.location.href +"&url="+ window.location.href);
                jQuery(".icons-twitter-icon").attr("href","https://twitter.com/share?text="+jQuery(this).attr("countrytitle")+"&url="+window.location.href);
                jQuery(".icons-linkedin-icon").attr("href", "https://www.linkedin.com/shareArticle?mini=true&url="+window.location.href);
                jQuery(".icons-google-icon").attr("href", "https://plus.google.com/share?url="+window.location.href+"&title="+ jQuery(this).attr("countrytitle") +"&summary="+jQuery(this).attr("countrytitle"));
                jQuery(".icons-copytoclip-icon").attr("href", window.location.href);

            });

            //Contact Map AJAX functionality
            if($(".region-contact-tab").length > 0 ) {
                $('.view-region-country-tab .regionCountry').click(function (e) {
                    getCountrymaps($(this).attr("countryid"));
                    $('.view-region-country-tab .regionCountry').removeClass('active');
                    $(this).addClass('active');
                    $('.loaderbtn').css('display','block');
                    $('body').addClass("loaderon");
                });
            }
            //FAQ Dynamic details AJAX functionality
            if($(".faq-category-wrapper").length > 0 ) {
                $('.faqCategoriesWrapper .category').click(function (e) {
                    getFaqTopic($(this).attr("termid"));
                    $('.faqCategoriesWrapper .category').removeClass('active');
                    $(this).addClass('active');
                    $('.loaderbtn').css('display','block');
                    $('body').addClass("loaderon");
                });
            }
            $(".field--name-field-counter-module-content table tr.draggable").each(function(){
                if ($(this).find(".field--name-field-module-layout select").val() == 'product') {
                    $(this).find(".field--name-field-counter-post-text").hide();
                    $(this).find(".field--name-field-counter-pre-text").hide();
                    $(this).find(".field--name-field-counter-number").hide();
                    $(this).find(".field--name-field-counter-suffix").hide();
                    $(this).find(".field--name-field-product-description").show();
                    $(this).find(".field--name-field-product-image").show();
                } else {
                    $(this).find(".field--name-field-counter-post-text").show();
                    $(this).find(".field--name-field-counter-pre-text").show();
                    $(this).find(".field--name-field-counter-number").show();
                    $(this).find(".field--name-field-counter-suffix").show();
                    $(this).find(".field--name-field-product-description").hide();
                    $(this).find(".field--name-field-product-image").hide();
                }
            });
            $(".field--name-field-module-layout select").on('change', function (e) {
                var newObject = $(this).closest('tr.draggable');
                var layoutSelected = $("option:selected", this);
                var layoutvalueSelected = this.value;
                if(layoutvalueSelected == "product") {
                    $(newObject).find(".field--name-field-counter-post-text").hide();
                    $(newObject).find(".field--name-field-counter-pre-text").hide();
                    $(newObject).find(".field--name-field-counter-number").hide();
                    $(newObject).find(".field--name-field-counter-suffix").hide();
                    $(newObject).find(".field--name-field-product-description").show();
                    $(newObject).find(".field--name-field-product-image").show();
                } else {
                    $(newObject).find(".field--name-field-counter-post-text").show();
                    $(newObject).find(".field--name-field-counter-pre-text").show();
                    $(newObject).find(".field--name-field-counter-number").show();
                    $(newObject).find(".field--name-field-counter-suffix").show();
                    $(newObject).find(".field--name-field-product-description").hide();
                    $(newObject).find(".field--name-field-product-image").hide();
                }
            });
            
            
            /*Auto complete JS for Country*/
            if($('#country-selection-form').length > 0){                
                set_select_to_autocomplete();
            }
            /*Auto complete JS for Country*/
            if($('#header-country-detail-form').length > 0){
                set_header_select_to_autocomplete();
            }

            /*Starts: Perspective Cookie submission for pre-applied filters
            * pre-applied campaign Filter
            */
            if($("#views-exposed-form-perspective-list-block-1").length > 0) {
                if(window.location.hash) {
                    checkHashValue();
                }
                if($('.perspectiveitem .perspectiveitemWrap .tags a.tag-perspectiveFilter-Link').length > 0) {
                    $('.perspectiveitem .perspectiveitemWrap .tags a.tag-perspectiveFilter-Link').click(function (e) {
                        //window.location.hash = "t="+$(this).attr('tagFilterId');
                        window.location.hash = "t="+jQuery(this).data("tagfilterid");
                        location.reload();
                    });
                }
            }
            /*Ends: Perspective Cookie submission for pre-applied filters*/
            
            /*=====Newsroom Section Country dropdown redirection starts========*/
            if($("#country-dropdown-selection-form").length > 0) {
                $("#country-dropdown-selection-form select").on('change', function (e) {
                    var countrySelected = $("option:selected", this);
                    var countryvalueSelected = this.value;
                    window.location = countryvalueSelected+"#media-contact-result-1";
                });
            }
            /*if($("#block-views-block-news-releases-block-2").length > 0) {
                $("#block-views-block-news-releases-block-2 form.views-exposed-form select option[value='All']").remove();
                $("#block-views-block-news-releases-block-2 form.views-exposed-form select option:first-child").attr("selected", "selected");
            }    */
            /*=====Newsroom Section Country dropdown redirection ends========*/
            
            jQuery('#block-localizationmenublock #edit-country-form').on('fadeIn', function(){
                previousCountry = jQuery('.countryDropdownOptions').val();
            });

            jQuery('#block-localizationmenublock #edit-country-form').on('fadeOut', function(){
                if(previousCountry !=  jQuery('.countryDropdownOptions').val() && typeof(previousCountry) != "undefined" && previousCountry != "") {
                    window.location.reload();
                }
            });

            if(jQuery("#block-views-block-perspective-list-block-1").length > 0)
            {
                jQuery(document).on("click",".type",function(){
                    if($("select[name='field_type_value']").val() != $("select[name='field_type_value'] option:contains("+jQuery(this).text()+")").val())
                    {
                        $("select[name='field_type_value']").val($("select[name='field_type_value'] option:contains("+jQuery(this).text()+")").val());
                        $('select').niceSelect('update');
                        $("select[name='field_type_value']").change();  
                    }
                });
            }
        }
    };
})(jQuery);

function set_select_to_autocomplete(){
    var countrylist2 = [];
    var countryid2 = '';
    $("#country-selection-form #edit-country--2 option").each(function (i) {
        if (i >= 0) {
            countrylist2.push(($(this).html().replace(/&amp;/g, "&")).toString());
        }
    });
    setTimeout(function () {
            $("#country-selection-form #edit-country-textfield--2").autocomplete({
                source: countrylist2,
                select: function (event, ui) {
                    var countryvalue = ui.item.value;
                    $("#country-selection-form #edit-country--2 option").each(function (i) {
                        if($(this).html() == countryvalue){
                           redirectionURL = "/countryLocationRedirection/" + $(this).val();
                           countryid2 = $(this).val();
                        }
                    });
                    if(redirectionURL) {
                        $.ajax({
                            type: "POST",
                            url: redirectionURL,
                            data: countryid2,
                            func: 'neglectCountrylocationRedrectionAjax',
                            success: function(data){
                                window.location = data;
                            }
                        });
                    }
                }
            });

            jQuery.validator.addMethod("countryAutoComplete_v2", function(value, element) {
                if(jQuery.inArray( value, countrylist2 ) >= 0)
                {
                    return true;
                }
                else{
                    return false;
                }
            }, 'Please enter valid country.');

            $("div.country-selection-form form#country-selection-form").validate({
                ignore: [],
                errorPlacement: function(error, element) {
                    if (element.is('select:hidden')) {
                        error.insertAfter(element.next('.nice-select'));
                    } else if(element[0].type == 'checkbox') {
                        error.insertAfter(element.parent(".control-label.option"));
                    }else {
                        error.insertAfter(element);
                    }        
                },
                submitHandler: function() {
                    countryvalue =  $( "div.country-selection-form form#country-selection-form #edit-country-textfield--2" ).val();
                    $("#country-selection-form #edit-country--2 option").each(function (i) {
                        if($(this).html() == countryvalue){
                           redirectionURL = "/countryLocationRedirection/" + $(this).val();
                           countryid2 = $(this).val();
                        }
                    });
                    if(redirectionURL) {
                        $.ajax({
                            type: "POST",
                            url: redirectionURL,
                            data: countryid2,
                            func: 'neglectCountrylocationRedrectionAjax',
                            success: function(data){
                                window.location = data;
                            }
                        });
                    }
                }
            });

            $( "div.country-selection-form form#country-selection-form #edit-country-textfield--2" ).rules( "add", {
                required: true,
                countryAutoComplete_v2: true
            });

    }, 500);
}

function set_header_select_to_autocomplete(){
    var countrylist = [];
    var countryid = '';
    $("#header-country-detail-form #edit-country option").each(function (i) {
        if (i >= 0) {
            countrylist.push(($(this).html().replace(/&amp;/g, "&")).toString());
        }
    });
    setTimeout(function () {
            $("#header-country-detail-form #edit-country-textfield").autocomplete({
                source: countrylist,
                change: function( event, ui ) {
                    //do nothing
                },                
                select: function (event, ui) {
                    var countryvalue = ui.item.value;
                    $("#header-country-detail-form #edit-country option").each(function (i) {
                        if($(this).html() == countryvalue){
                           redirectionURL = "/countryRedirection/" + $(this).val();
                           countryId = $(this).val();
                        }
                    });
                    if(redirectionURL) {
                        $.ajax({
                            type: "POST",
                            url: redirectionURL,
                            data: countryId,
                            func: 'neglectCountryRedrectionAjax',
                            success: function(data){
                                window.location = data;
                            }
                        });
                    }
                }
            });

            jQuery.validator.addMethod("countryAutoComplete", function(value, element) {
                if(jQuery.inArray( value, countrylist ) >= 0)
                {
                    return true;
                }
                else{
                    return false;
                }
            }, 'Please enter valid country.');

            $("#header form#header-country-detail-form").validate({
                ignore: [],
                errorPlacement: function(error, element) {
                    if (element.is('select:hidden')) {
                        error.insertAfter(element.next('.nice-select'));
                    } else if(element[0].type == 'checkbox') {
                        error.insertAfter(element.parent(".control-label.option"));
                    }else {
                        error.insertAfter(element);
                    }        
                },
                submitHandler: function() {
                    countryvalue =  $( "#header #edit-country-textfield" ).val();
                    $("#header-country-detail-form #edit-country option").each(function (i) {
                        if($(this).html() == countryvalue){
                           redirectionURL = "/countryRedirection/" + $(this).val();
                           countryId = $(this).val();
                        }
                    });
                    if(redirectionURL) {
                        $.ajax({
                            type: "POST",
                            url: redirectionURL,
                            data: countryId,
                            func: 'neglectCountryRedrectionAjax',
                            success: function(data){
                                window.location = data;
                            }
                        });
                    }
                }
            });

            $(".mmenu form#header-country-detail-form").validate({
                ignore: [],
                errorPlacement: function(error, element) {
                    if (element.is('select:hidden')) {
                        error.insertAfter(element.next('.nice-select'));
                    } else if(element[0].type == 'checkbox') {
                        error.insertAfter(element.parent(".control-label.option"));
                    }else {
                        error.insertAfter(element);
                    }        
                },
                submitHandler: function() {
                    countryvalue =  $( ".mmenu form#header-country-detail-form #edit-country-textfield" ).val();
                    $(".mmenu form#header-country-detail-form #edit-country option").each(function (i) {
                        if($(this).html() == countryvalue){
                           redirectionURL = "/countryRedirection/" + $(this).val();
                           countryId = $(this).val();
                        }
                    });
                    if(redirectionURL) {
                        $.ajax({
                            type: "POST",
                            url: redirectionURL,
                            data: countryId,
                            func: 'neglectCountryRedrectionAjax',
                            success: function(data){
                                window.location = data;
                            }
                        });
                    }
                }
            });

            $( "#header #edit-country-textfield" ).rules( "add", {
                required: true,
                countryAutoComplete: true
            });

            $( ".mmenu form#header-country-detail-form #edit-country-textfield" ).rules( "add", {
                required: true,
                countryAutoComplete: true
            });

    }, 500);
}


function twittersliderfn() {
    if($('.twitterslider .fedd-item').length > 1){
        jQuery('.twitterslider').slick({
            dots: true,
            speed: 800,
            arrows: false,
            infinite: false,
            slidesToShow: 1,
            slidesToScroll: 1,       
            focusOnSelect: false,
            adaptiveHeight: true,
        });
    }
}



function changePerspectiveHeader(campaign) {
    if(campaign) {
        campaign = campaign;
    } else {
        campaign = 0;
    }
    var nid = drupalSettings.nid;
    var redirectionURL = "/campaign/"+campaign+"/"+nid;
    $.ajax({
        type: "POST",
        url: redirectionURL,
        data: campaign,
        func: 'neglectCampaignAjax',
           success: function(data){
            $('div#bannerwrapper .form-group').html(data);
            twittersliderfn();
            jQuery('.counterData').counterUp({
                delay: 110, // the delay time in ms
                time: 3900 // the speed time in ms
            });
            jQuery("html, body").animate({
                scrollTop: jQuery('body').offset()
            }, 200);
            if(sessionStorage.getItem("eventgridorlist")) {
                if(sessionStorage.getItem("eventgridorlist") == "grid") {
                    jQuery('.perspectiveSection .view-header .gridList span').removeClass('active');
                    jQuery(".perspectiveSection .view-header .gridList .gridIcon").addClass('active');
                    jQuery('.perspectiveSection .gridview').fadeIn();
                    jQuery('.perspectiveSection .listview').fadeOut();
                } else {
                    jQuery('.perspectiveSection .view-header .gridList span').removeClass('active');
                    jQuery(".perspectiveSection .view-header .gridList .listIcon").addClass('active');
                    jQuery('.perspectiveSection .listview').fadeIn();
                    jQuery('.perspectiveSection .gridview').fadeOut();
                }
            } else {
                //Active grid
                sessionStorage.eventgridorlist = "grid";
                jQuery('.perspectiveSection .view-header .gridList span').removeClass('active');
                jQuery(".perspectiveSection .view-header .gridList .gridIcon").addClass('active');
                jQuery('.perspectiveSection .gridview').fadeIn();
                jQuery('.perspectiveSection .listview').fadeOut();
            }

            
            /* Js for no banner in campaign page*/
            if(jQuery('.bannershowWrapper').find('.banneritem').length == 0){
                // alert();
                jQuery('body').addClass('nobanner');
                jQuery('header').addClass('active');
                jQuery('.campaignContentSectionWrapper').css('margin-top','115px');
            }  

            /*if(jQuery(window).width() > 991) {
                jQuery('.campaignContentSectionWrapper .EqualHeight').css('min-height','1400px');
                jQuery('.page-type-perspective .campaignquoteTweetWrapper').css('min-height','inherit');
                
            }*/
            
            jQuery('.loaderbtn').css('display','none');
            $('body').removeClass("loaderon"); 
            
        }
    });
}


function mapinit() {    
    // Basic options for a simple Google Map
    // For more options see: https://developers.google.com/maps/documentation/javascript/reference#MapOptions
    setTimeout(function(){
        init();
    },1500);
}

function setCounter() {
    jQuery('.counterData').counterUp({
        delay: 110, // the delay time in ms
        time: 3900 // the speed time in ms
    });
}

function setEqualHeight(arr) {
    var x = new Array([]);
    for (i = 0; i < arr.length; i++) {
        x[i] = jQuery(arr[i]).height('auto');
        x[i] = jQuery(arr[i]).height();
    }
    Max_Value = Array.max(x);
    for (i = 0; i < arr.length; i++) {       
        x[i] = jQuery(arr[i]).height(Max_Value);
    }
}
Array.max = function (array) {
    return Math.max.apply(Math, array);
};





function getCountryInfromation(countryId) {
    if(countryId) {
        countryId = countryId;
    } else {
        countryId = 0;
    }
    var redirectionURL = "/getcountry/"+countryId;
    $.ajax({
        type: "POST",
        url: redirectionURL,
        data: countryId,
        func: 'neglectCountryAjax',
        success: function(data){
            var urlpathname = window.location.pathname;
            var urlpathnamearr = urlpathname.split("/");
            
            if( urlpathnamearr[1] == 'pl' ){
               $('div.regionCountryTabResponse').removeClass('content-lang-pl');
               $('div.regionCountryTabResponse').addClass('content-lang-'+urlpathnamearr[1]); 
            }
            else{
                $('div.regionCountryTabResponse').removeClass('content-lang-pl');
            }
            
            $('div.regionCountryTabResponse').html(data); 
            
            if( jQuery(".map").length > 0 ) {
               mapinit();   
            }

            //Service change - please do not change here
            jQuery("body.where-we-operate .views-field-field-related-document .field--name-field-document-file .file-link a").text('');
            jQuery("body.where-we-operate .views-field-field-related-document .field--name-field-document-title").append('<div class="relatedDocumentDescription"><span class="relatedDocumentExtension">PDF</span><span class="size"> </span></div>');

            jQuery('body.where-we-operate .views-field-field-related-document .field--name-field-document-tags .field--item a').each(function(){
                  
                   jQuery('body.where-we-operate .views-field-field-related-document .field--name-field-document-tags .field--item a').addClass('tag-perspectiveFilter-Link');

                    var relatedLinkurl = jQuery(this).attr('href');
                    
                    var relatedLinkurlArr = relatedLinkurl.split("/");
                    jQuery(this).attr("href","/our-views#t="+relatedLinkurlArr[3]+"");
                    jQuery(this).data("tagfilterid",relatedLinkurlArr[3]);
                    //jQuery(this).attr("tagfilterid",relatedLinkurlArr[3]);

            });
//End    

            // jQuery(".where-we-operate .brandsWrapper .dropbtn").addClass('active');
            jQuery('.where-we-operate .countryInfromationWrapper .brandsWrapper .dropbtn').addClass('active');
            jQuery(".brandsWrapper .dropbtn").click(function (){
                if(jQuery(this).hasClass('active')){
                   jQuery(this).removeClass('active');
                   jQuery('.where-we-operate .countryInfromationWrapper .brandsWrapper .brand-header').addClass('activecc');
                   jQuery(".where-we-operate .brandsWrapper .view-content").slideUp(function () {
                        jQuery("html, body").animate({
                            scrollTop: jQuery(this).parent().offset().top - 90
                        }, 500);
                    });
                }else{
                   jQuery(this).addClass('active');
                   jQuery('.where-we-operate .countryInfromationWrapper .brandsWrapper .brand-header').removeClass('activecc');
                   jQuery(".where-we-operate .brandsWrapper .view-content").slideDown(function () {
                        jQuery("html, body").animate({
                            scrollTop: jQuery(this).parent().offset().top - 90
                        }, 500);

                        setTimeout(function(){
                            /* ---- Counter equal height ----- */
                            if(jQuery(".counterWrapper .counterWithoutSlider").length){
                                if(counterEqualHeight && typeof counterEqualHeight !== 'undefined') {
                                    counterEqualHeight.reGroup();
                                }else{
                                    counterEqualHeightFunction();
                                }
                            }
                        },1000);
                        
                    });
                }
            }); 

            if(jQuery('.where-we-operate .newsSection .newsWrap .newsitem').length > 6){
                var selectListdata = [];
                var option;
                $(".newsWrap .newsitem").each(function(index){
                    if(jQuery.inArray($(this).data('year'),selectListdata) == -1)
                        selectListdata.push($(this).data('year'));
                });
                option = '<div class="filter-by-year"><label for="edit-field-news-year-target-id" class="control-label">Filter by year</label>'
                //option += '<select class="filter-news"><option>All</option>';
                option += '<select class="filter-news">';
                for (var i=0;i<selectListdata.length;i++){
                   if(typeof selectListdata[i] != "undefined") {
                    option += '<option value="'+ selectListdata[i] + '">' + selectListdata[i] + '</option>';
                   } 
                    //option += '<option value="'+ selectListdata[i] + '">' + selectListdata[i] + '</option>';
                }
                option += '</select></div>';
                $(option).appendTo(".newsLabelWrapper");
                jQuery('.filter-by-year .filter-news').niceSelect();
                $(document).on("change",".filter-news",function(){
                    var year = $(this).val();
                    if(year == "All")
                    {
                        year = ".newsitem"
                    }
                    else{
                       year = "."+year
                    }
                    $(".newsWrap").isotope({ filter: year});
                });
                //Select the first option from news
                setTimeout(function(){
                    newsWrapWhereIsotope = $(".newsWrap").isotope({ filter: "."+$(".newsLabelWrapper .filter-by-year ul.list li:first-child").data('value')});
                    $(".nice-select.filter-news.open").removeClass("open");
                },0);
                /*jQuery('.where-we-operate .newsSection .newsWrap .newsitem:lt(4)').wrapAll('<div class="firstfour"></div>');
                jQuery('.where-we-operate .newsSection .newsWrap .firstfour').append('<span class="dropbtn"></span>');
                jQuery('.where-we-operate .newsSection .newsWrap .firstfour').nextAll('.newsitem').wrapAll('<div class="allnewsitemwrap"></div>');
                jQuery('.where-we-operate .newsSection .newsWrap .firstfour .dropbtn').click(function(e){
                    if(jQuery(this).hasClass('active')){  
                        jQuery(this).removeClass('active');
                        jQuery(this).parent('.firstfour').next().slideUp();
                    }
                    else{
                        jQuery(this).addClass('active');                      
                        jQuery(this).parent('.firstfour').next().slideDown(); 
                    }
                });*/
            }   else {
                if(jQuery('body.where-we-operate .countryNewsWrapper .newsSection .newsWrap .newsitem').length > 0){
                    option = '<div class="filter-by-year no-filter-required"></div>';
                    $(option).appendTo(".newsLabelWrapper");
                }
            }
            
            // jQuery('.where-we-operate .brandsWrapper .brandrows:nth-child(odd)').addClass('odd');
            // jQuery('.where-we-operate .brandsWrapper .brandrows:nth-child(even)').addClass('even');

            // jQuery( ".where-we-operate .brandsWrapper .brandrows:nth-child(odd)" ).each(function() {
            //    var oddboxheight = jQuery(this).height();
            //    jQuery( this ).next('.even').css('height',oddboxheight);
            //    var evenboxheight = jQuery( this ).next('.even').height();
            //    if(oddboxheight >= evenboxheight){
            //         jQuery( this ).css('height',oddboxheight);
            //         jQuery( this ).next('.even').css('height', oddboxheight);
            //    }else{
            //         jQuery( this ).css('height',evenboxheight);
            //         jQuery( this ).next('.even').css('height', evenboxheight);
            //    }
            // });
           
            //setEqualHeight([".where-we-operate .countryInfromationWrapper .brandsWrapper .view-content .views-field"]);
            setCounter();
            jQuery('.loaderbtn').css('display','none');
            $('body').removeClass("loaderon");
            if(jQuery('.where-we-operate .countryBannerWrapper').length > 0) {
                jQuery("html, body").animate({
                    scrollTop: jQuery('.where-we-operate .countryBannerWrapper').parent().offset().top - 90
                }, 800);
            }
            $("#where-we-opearate-lang-switcher").niceSelect();
            $(".where-we-operate .countryReferenceWrapper .country-language-switcher .nice-select ul li").on('click', function (e) {
                currenturl = $(this).attr('data-value');
                window.location = '/' + currenturl;
            });

            if (jQuery(window).width() > 767) {
                // jQuery('.where-we-operate .countryReferenceWrapper .counterSection .counterSlider').unslick();
                // setEqualHeight_CommonClass(".where-we-operate .brandsWrapper .brandrows");  
                setEqualHeight([".where-we-operate .countryInfromationWrapper .relatedDocWrapper .related-documents"]);
            }else{
                jQuery('.where-we-operate .countryReferenceWrapper .counterSection .counterSlider').slick({
                    slidesToShow: 1,
                    slidesToScroll: 1,
                    dots: true,
                    infinite: false,
                    arrows: false,
                    speed: 800,                       
                });
                jQuery('.where-we-operate .countryReferenceWrapper .counterWrapper .counterWithoutSlider').slick({
                    slidesToShow: 1,
                    slidesToScroll: 1,
                    dots: true,
                    infinite: false,
                    arrows: false,
                    speed: 800,                       
                });
                jQuery('.where-we-operate .brandsWrapper .brandrows').css('height','auto');
                jQuery('.where-we-operate .countryInfromationWrapper .relatedDocWrapper .related-documents').css('height','auto');
            }
            /* --------- Equal height Stars -------- */
            perspectiveSection();
            contactBoxEqualHeight();
            latestNewsCountry();
            additionalNewsCountry();
            /* --------- Equal height ends -------- */
        }
    });
}



function getCountrymaps_success(){
    if(jQuery('body').hasClass('where-we-operate')) {
        if(jQuery('.where-we-operate .our-global-reachWrapper .field--name-field-reference-contents  .field--item:first-child .firsttab').length == 0){
            var tab_text = jQuery('.our-global-reachWrapper .field--name-field-reference-contents  .field--item:first-child h2').html();
            if(tab_text == undefined){
                tab_text = 'Global';
            }else{
                tab_text = tab_text;
            }            
            jQuery('.our-global-reachWrapper .field--name-field-reference-contents  .field--item:first-child').prepend("<div class='tabtitle firsttab'>"+ tab_text +"</div>");

            /*jQuery('.our-global-reachWrapper .field').prepend('<ul class="tabLabels"></ul>');*/ 
            jQuery(".our-global-reachWrapper .field--name-field-reference-contents  .field--item .tabtitle").each(function(){
                var tab_textdf = jQuery(this).html();
                var tab_Title = jQuery(this).html();
                tab_textdf = tab_textdf.replace(' ', '').toLowerCase();
                jQuery(this).addClass(tab_textdf);
                jQuery(".our-global-reachWrapper .field  ul.tabLabels").append("<li class="+tab_textdf+">"+tab_Title+"</li>");          
            });

        }
        jQuery('.where-we-operate .our-global-reachWrapper .field  ul.tabLabels li:first-child').addClass('current');
        jQuery(".where-we-operate .our-global-reachWrapper .field  ul.tabLabels li").click(function (){
            if($(this).hasClass('current')){
            }else{            
                if($(this).hasClass('global')){
                    jQuery(".our-global-reachWrapper .field  ul.tabLabels li").removeClass('current');
                    jQuery(".our-global-reachWrapper .regiontabWrapper .tabitemWrap").hide();
                    $('.view-region-country-tab .regionCountry').removeClass('active'); 
                    jQuery(".where-we-operate .regionCountryTabResponse").html('');
                    $(this).addClass('current');
                    jQuery(".our-global-reachWrapper .counterSection").show();
                    jQuery(".our-global-reachWrapper .fullImagebannerSection").show();
                    jQuery(".our-global-reachWrapper .leftrightcontent").show();
                }else{
                    jQuery(".our-global-reachWrapper .field  ul.tabLabels li").removeClass('current');
                    jQuery(".our-global-reachWrapper .counterSection").hide();
                    jQuery(".our-global-reachWrapper .fullImagebannerSection").hide();
                    jQuery(".our-global-reachWrapper .leftrightcontent").hide();
                    jQuery(".our-global-reachWrapper .regiontabWrapper .tabitemWrap").hide();
                    $('.view-region-country-tab .regionCountry').removeClass('active');
                    jQuery(".where-we-operate .regionCountryTabResponse").html('');
                    $(this).addClass('current');
                    // var tabvalue = '.' + $(this).html();
                    var tab_textdf = jQuery(this).html();
                    tab_textdf = tab_textdf.replace(' ', '').toLowerCase();
                    var tabvalue = '.' + tab_textdf;
                    jQuery(".our-global-reachWrapper .regiontabWrapper").find(tabvalue).next().show();
                }

            }
        });
        jQuery(".where-we-operate .our-global-reachWrapper .field  ul.tabLabels li.current").click(function (e) { e.stopPropagation(); });

        /*===Country selection form Js for Insert form in first tab===*/
        if(jQuery(".country-selection-form").length > 0){
            if(jQuery(".our-global-reachWrapper .field .field--item").length > 0){
                var countryselectionform = jQuery('.country-selection-form').html();                    
                jQuery(".our-global-reachWrapper .field .field--item .leftrightcontent ").append('<div class="country-selection-form">' + countryselectionform + '</div>');
            }                
        }
        set_select_to_autocomplete();
        if (jQuery(window).width() > 767) {
            jQuery(".where-we-operate.contactus ul.tabLabels").show();
            jQuery(".where-we-operate.contactus .mobicurr").hide();
        }else{

            jQuery(".where-we-operate .tabLabelswrapper ul.tabLabels").hide();
            jQuery(".where-we-operate .tabLabelswrapper .mobicurr").show();
            jQuery('.tabwrapperrr').css({'width':'50%','margin':'0 auto'});
            if(jQuery('.where-we-operate .tabLabelswrapper .mobicurr').length == 0){
                jQuery("<div class='mobicurr'></div>").insertBefore('.tabLabelswrapper .tabLabels');          
            }
            setTimeout(function(){ 
                var sdadfs = jQuery(".where-we-operate .tabLabelswrapper .tabLabels li.current").html();
                jQuery('.mobicurr').html(sdadfs);
            }, 200); 
            jQuery('.where-we-operate .tabLabelswrapper .mobicurr,.where-we-operate .tabLabelswrapper .tabLabels').wrapAll('<div class="tabwrapperrr"></div>');                
            if (jQuery('.where-we-operate .tabLabels li').length > 1) {                
                jQuery(".mobicurr").unbind().click(function (){
                    if (jQuery(this).hasClass('open')) {
                        jQuery(this).removeClass("open");
                        jQuery(this).next('ul').slideUp();
                    } else {
                        jQuery(this).addClass("open");
                        jQuery(this).next('ul').slideDown("slow");
                    }
                });
                jQuery(".where-we-operate .our-global-reachWrapper .tabLabelswrapper ul.tabLabels li").click(function (){
                    var sdadfs = jQuery(this).html();
                    jQuery('.mobicurr').html(sdadfs);
                    jQuery('.mobicurr').removeClass("open");
                    jQuery('.mobicurr').next('ul').slideUp();
                });            
            }
        }
    }
}
function getCountrymaps(countryId) {
    if(countryId) {
        countryId = countryId;
    } else {
        countryId = 0;
    }
    var redirectionURL = "/getcountryMap/"+countryId;
    $.ajax({
        type: "POST",
        url: redirectionURL,
        data: countryId,
        func: 'neglectCountryAjax',
        success: function(data){
            $('div.regionCountryTabResponse').html(data); 
            jQuery('.loaderbtn').css('display','none');
            $('body').removeClass("loaderon");
            if( jQuery(".map").length > 0 ) {
               mapinit();   
            }           
            
            jQuery('.where-we-operate .countryInfromationWrapper .brandsWrapper .brand-header').addClass('activecc');
            jQuery(".brandsWrapper .dropbtn").click(function (){
                if(jQuery(this).hasClass('active')){
                   jQuery(this).removeClass('active');
                   jQuery('.where-we-operate .countryInfromationWrapper .brandsWrapper .brand-header').addClass('activecc');
                   jQuery(".where-we-operate .brandsWrapper .view-content").slideUp(function () {
                        jQuery("html, body").animate({
                            scrollTop: jQuery(this).parent().offset().top - 90
                        }, 500);
                    });
                }else{
                   jQuery(this).addClass('active');
                   jQuery('.where-we-operate .countryInfromationWrapper .brandsWrapper .brand-header').removeClass('activecc');
                   jQuery(".where-we-operate .brandsWrapper .view-content").slideDown(function () {
                        jQuery("html, body").animate({
                            scrollTop: jQuery(this).parent().offset().top - 90
                        }, 500);

                        setTimeout(function(){
                            /* ---- Counter equal height ----- */
                            if(jQuery(".counterWrapper .counterWithoutSlider").length){
                                if(counterEqualHeight && typeof counterEqualHeight !== 'undefined') {
                                    counterEqualHeight.reGroup();
                                }else{
                                    counterEqualHeightFunction();
                                }
                            }
                        },1000);
                    });
                }
            });
            
        }
    });
}



function getFaqTopic(termId) {
    var redirectionURL = "/getFaqTopic/"+termId;
    $.ajax({
        type: "POST",
        url: redirectionURL,
        data: termId,
        func: 'neglectFaqTermAjax',
        success: function(data){
            $('div.faqTopicsResponseWrapper').html(data);
            $('.faq-category-wrapper').addClass('faqdes-active');
            $('.faqDetailResponse').html('');
            $('.topic').on( "click", function() {                
                getFaqDetail($(this).attr("topicid"));
                $('.topic').removeClass('active');
                $(this).addClass('active');
                $('.loaderbtn').css('display','block');
                $('body').addClass("loaderon");
            });
            jQuery(".contactus .faqDetailResponse, .contactus .regionCountryTabResponse").html('');
            jQuery('.loaderbtn').css('display','none');
            $('body').removeClass("loaderon");
        }
    });
}


function getFaqDetail(topicId) {
    var redirectionURL = "/getFaqDetail/"+topicId;
    $.ajax({
        type: "POST",
        url: redirectionURL,
        data: topicId,
        func: 'neglectFaqDetailAjax',
        success: function(data){
            $('div.faqDetailResponse').html(data);
            getCountrymaps_success();
            //Contact Map AJAX functionality
            if($(".faqDetailResponse").length > 0 ) {
                $('.view-region-country-tab .regionCountry').click(function (e) {
                    getCountrymaps($(this).attr("countryid"));
                    $('.view-region-country-tab .regionCountry').removeClass('active');
                    $(this).addClass('active');                                       
                    $('.loaderbtn').css('display','block');
                    $('body').addClass("loaderon");
                });
            }
            jQuery('.contactus .faqDetailResponse .our-global-reachWrapper').prepend('<div class="closebtn">close</div>');
            jQuery(".where-we-operate.contactus .our-global-reachWrapper .closebtn").click(function (){
                jQuery("html, body").animate({
                    scrollTop: jQuery('.faq-category-wrapper').offset().top - 180
                }, 500); 
                $('.faq-category-wrapper').removeClass('faqdes-active');
                jQuery(".contactus .faqDetailResponse, .contactus .regionCountryTabResponse").html('');                               
            });
            $('html, body').animate({
                scrollTop: $(".our-global-reachWrapper").offset().top-90
            }, 800);
            jQuery('.loaderbtn').css('display','none');
            $('body').removeClass("loaderon");
        }
    });
}

//get number of days in a month and year
function daysInMonth(month,year) {
    month = month + 1;
    return new Date(year, month, 0).getDate();
}

/*function WhichButton(event) {
    jQuery(event.target).trigger('click');
}*/
function tagWhichButton(event) {
    //Check if not IE browser
    if (detectIE() == false )
    { 
        if(jQuery(event.target).parent('a').attr('data-href')) {
            if(event.button == 0) {
                jQuery(event.target).parent('a').attr('target', '_self');
                jQuery(event.target).parent('a').prop('href', jQuery(event.target).parent('a').attr('data-href'));
                try{
                    jQuery(event.target).parent('a').trigger('click');    
                }
                catch(e){
                    //do nothing
                }
                window.location.href = jQuery(event.target).parent('a').attr('data-href');
                window.location.reload();
            } else {
                jQuery(event.target).parent('a').attr('target', '_blank');
                jQuery(event.target).parent('a').prop('href', jQuery(event.target).parent('a').attr('data-href'));
                jQuery(event.target).parent('a').trigger('click');
            }
        } else {
            jQuery(event.target).attr('href', jQuery(event.target).attr('data-href'));
            jQuery(event.target).trigger('click');
            // if(event.button == 0) {
            window.location.href = jQuery(event.target).parent('a').attr('data-href');
            window.location.reload();
            // }
        }
    }
    else{
        window.location.href = jQuery(event.target).parent('a').attr('data-href');
        if( window.location.href.indexOf("our-views") > 0)
        {
            window.location.reload();
        }
    }
    
}

/**
 * detect IE
 * returns version of IE or false, if browser is not Internet Explorer
 */
function detectIE() {
    var ua = window.navigator.userAgent;

    var msie = ua.indexOf('MSIE ');
    if (msie > 0) {
        // IE 10 or older => return version number
        return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);
    }

    var trident = ua.indexOf('Trident/');
    if (trident > 0) {
        // IE 11 => return version number
        var rv = ua.indexOf('rv:');
        return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);
    }

    var edge = ua.indexOf('Edge/');
    if (edge > 0) {
       // Edge (IE 12+) => return version number
       return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);
    }

    // other browser
    return false;
}

//Pre-filtered values for perspective list page
function checkHashValue() {
    if(window.location.hash) {
        if (window.location.hash.indexOf("&") !=-1) {
            var splitIds = window.location.hash.split("&");
            var campaignhasValues = splitIds[0].split("=");
            var taghasValues = splitIds[1].split("=");
            var jumplinkhasValues = [];
            if ( typeof splitIds[2] !== "undefined" && splitIds[2]){
            var jumplinkhasValues = splitIds[2].split("=");}
            var tagOptions = [];
            $(".form-checkboxes input.form-checkbox").each(function() {
                tagOptions.push($(this).val());
            });
            if((jQuery.inArray(taghasValues[1], tagOptions) !== -1) && taghasValues[1]) {
                var checkBoxId = $("input#edit-field-tags-target-id-"+taghasValues[1]);
                $(checkBoxId).attr("checked",true).change();
                setTimeout(function(){
                    $('#views-exposed-form-perspective-list-block-1 .form-type-checkbox').trigger('change');
                }, 100);
            }
            var campaignOptions = [];
            $("select.campaignSelector option").each(function() {
                campaignOptions.push($(this).val());
            });
            if ( typeof jumplinkhasValues[0] !== "undefined" && jumplinkhasValues[0]){
            setTimeout(function(){
            if(jumplinkhasValues[0]=='r')
                {
                  
                  var ele = jumplinkhasValues[1];
                  if(jQuery(ele).length>0)
                     jQuery('html, body').animate({   scrollTop: jQuery(ele).offset().top-90}, 2000);
                }   
            },2000);}
            
            if((jQuery.inArray(campaignhasValues[1], campaignOptions) !== -1) && campaignhasValues[1]) {
                jQuery("#edit-field-select-campaign-target-id").val(campaignhasValues[1]);
                gaEventTackingCall();
                changePerspectiveHeader(campaignhasValues[1]);
                
                window.location.hash = "";
                $('.loaderbtn').css('display','block');
                $('body').addClass("loaderon");
            }   else {
                window.location.hash = "";
            }
        } else {
            var hasValues = window.location.hash.split("=");
            if(hasValues[0] == "#c") {               
                var campaignOptions = [];
                $("select.campaignSelector option").each(function() {
                    campaignOptions.push($(this).val());
                });
                if((jQuery.inArray(hasValues[1], campaignOptions) !== -1) && hasValues[1]) {
                    jQuery("#edit-field-select-campaign-target-id").val(hasValues[1]);
                    gaEventTackingCall();
                    changePerspectiveHeader(hasValues[1]);
                    window.location.hash = "";
                    $('.loaderbtn').css('display','block');
                    $('body').addClass("loaderon");
                } else {
                    window.location.hash = "";
                }                
            }
            if(hasValues[0] == "#t") {
                var tagOptions = [];
                $(".form-checkboxes input.form-checkbox").each(function() {
                    tagOptions.push($(this).val());
                });
                if((jQuery.inArray(hasValues[1], tagOptions) !== -1) && hasValues[1]) {
                    var checkBoxId = $("input#edit-field-tags-target-id-"+hasValues[1]);
                    $(checkBoxId).attr("checked",true).change();
                    setTimeout(function(){
                    $('#views-exposed-form-perspective-list-block-1 .form-type-checkbox').trigger('change');
                        window.location.hash = "";
                    }, 100);
                } else {
                    window.location.hash = "";
                }
            }
            if(hasValues[0] == "#region"){
                if($(".tabLabels").length>0)
                {
                    $('html, body').animate({
                        scrollTop: $(".tabLabels").offset().top-90
                    }, 800);
                    $("."+hasValues[1]).click();
                    window.location.hash = "tabLabels";
                }
            }
            if(hasValues[0] == "#regioncountry"){
                if($(".tabLabels").length>0)
                {
                    $('html, body').animate({
                        scrollTop: $(".tabLabels").offset().top-90
                    }, 800);
                    var getCountryId = hasValues[1].split("+");
                    $("."+getCountryId[0]).click();
                    setTimeout(function(){
                        $("#country-"+getCountryId[1]).click();
                    },1000);
                    window.location.hash = "tabLabels";
                }
            }
       }    
    }
    
    setTimeout(function(){
        check_hash_tag();
    },2000);
}
function check_hash_tag(){
    //Code to show tag if any selected
    if(jQuery(".form-type-checkbox label.checked").length>0)
    {
        jQuery(".block-views-blockperspective-list-block-1 .form-type-checkbox").show();
    }
    if($('.loaderbtn').is(":visible")) {
        setTimeout(function(){
            check_hash_tag();
        },2000);
    }
}

function link_is_external(link_element) {
    if(link_element.host != "") {
        return (link_element.host !== window.location.host);
    }
}

function gaEventTackingCall() {
    var track = true;
    var href = window.location.href;
    var elEv = []; elEv.value=0, elEv.non_i=false;
    elEv.category = 'CampaignEvent';
    elEv.action = 'CampaignClick';
    elEv.label = href.replace(/^http(s?)\:\/\//i, '');
    //elEv.non_i = true;
    elEv.loc = href;
    var ret = true;
    hrefRedirect = elEv.loc;

    if(typeof ga != "undefined")
    {
        ga('send','event', elEv.category.toLowerCase(),elEv.action.toLowerCase(),elEv.label.toLowerCase(),elEv.value,{
        'nonInteraction': elEv.non_i
        });
    } 
    
    return false;
}

/*
* This function is used for localization menu country langauge selection
* Based on country selection, the language dropdown changes
*/
function changeOfCountrytoChangeLanguage(evt, params) {
    var selectedCountry = params.selected;
    $("#localization-menu-form .country-change-loader").show();

    if($("#block-views-block-perspective-list-block-1").length > 0 ) { 
        sessionStorage.setItem("countryChangeAjax", "views-started");
    }
    if(selectedCountry) {
        var langauageCheckURL = "/changecountrylanguage/"+selectedCountry;
        $.ajax({
            type: "POST",
            url: langauageCheckURL,
            data: selectedCountry,
            func: 'neglectCcountryLangaugeAjax',
            dataType:"json",
            success: function(data){
                sessionStorage.setItem("countryChange", "changed");
                sessionStorage.setItem("countryChangeURL", window.location.href);
                $("#localization-menu-form select#edit-language").html();
                if (typeof data.countryName !== "undefined" && data.countryName != '') {
                    $("#localization-menu-form .snapContent .countryName").html("<strong>"+data.countryName+"</strong>");
                    $("#localization-menu-form .your-location-message .countryName").html(data.countryName);
                }   
                if (typeof data.langauges !== "undefined" && data.langauges != '') {
                    $("#localization-menu-form select#edit-language").show();
                $("#localization-menu-form .form-item-language").show();
                    $("#localization-menu-form select#edit-language").attr('disabled', false).trigger("liszt:updated");
                    $("#localization-menu-form select#edit-language").html(data.langauges);
                } else {
                    $("#localization-menu-form select#edit-language").attr('disabled', true).trigger("liszt:updated");
                 $("#localization-menu-form .form-item-language").hide();
                   $("#localization-menu-form select#edit-language").hide();
                }

                if (typeof data.headOffice !== "undefined" && data.headOffice != '') {
                    $(".region-footer-center #block-footercountrycontactblock").show();
                    $(".region-footer-center #block-footercountrycontactblock").html(data.headOffice);
                } else {
                    $(".region-footer-center #block-footercountrycontactblock").hide();
                }

                if (typeof data.languageContent.countryLink !== "undefined" && data.languageContent.countryLink != '') {
                    $("#localization-menu-form .dynamicCountryButton").show();
                    $("#localization-menu-form .dynamicCountryButton").html(data.languageContent.countryLink);
                } else {
                    $("#localization-menu-form .dynamicCountryButton").hide();
                }
                if (typeof data.languageContent.welcomeText !== "undefined" && data.languageContent.welcomeText != '') {
                    $("#localization-menu-form .title").html(data.languageContent.welcomeText);
                }

                if (typeof data.languageContent.locatorText !== "undefined" && data.languageContent.locatorText != '') {
                    $("#localization-menu-form .snapContent span.current-location").html(data.languageContent.locatorText);
                }

                if (typeof data.languageContent.changeCountryText !== "undefined" && data.languageContent.changeCountryText != '') {
                    $("#localization-menu-form .snapContent span.changeCountryText").html(data.languageContent.changeCountryText);
                }
                

                $("#localization-menu-form select#edit-language").chosen('destroy');
                $("#localization-menu-form select#edit-language").chosen({
                    disable_search_threshold: 2,
                    no_results_text: "No result found",
                    placeholder_text_single: "Select language",
                    width: "100%"
                });
                $("#localization-menu-form .country-change-loader").hide();
            }
        });
    }
}

/*
* This function is used for localization menu langauge selection
* Based on langauge selection, the language content changes in localization menu
*/
function changeOfLanguagetoChangeContent(evt, params) {
    var selectedCountry = $("#localization-menu-form select.countryDropdownOptions").val();
    var selectedLang = params.selected;
    $("#localization-menu-form .country-change-loader").show();
    if(selectedCountry) {
        var langauageCheckURL = "/changecountrylanguagecontent/"+selectedCountry+"/"+selectedLang;
        if($("#block-views-block-perspective-list-block-1").length > 0 ) { 
            sessionStorage.setItem("countryChangeAjax", "views-started");
        }

        $.ajax({
            type: "POST",
            url: langauageCheckURL,
            data: { country: selectedCountry, lang: selectedLang, countryChange: 'null' },
            func: 'neglectLangaugeContentAjax',
            dataType:"json",
            success: function(data){

                if (typeof data.welcomeText !== "undefined" && data.welcomeText != '') {
                    $("#localization-menu-form .title").html(data.welcomeText);
                }

                if (typeof data.countryName !== "undefined" && data.countryName != '') {
                    $("#localization-menu-form .snapContent .countryName").html("<strong>"+data.countryName+"</strong>");
                }
                if (typeof data.locatorText !== "undefined" && data.locatorText != '') {
                    $("#localization-menu-form .snapContent span.current-location").html(data.locatorText);
                }

                if (typeof data.changeCountryText !== "undefined" && data.changeCountryText != '') {
                    $("#localization-menu-form .snapContent span.changeCountryText").html(data.changeCountryText);
                }

                if (typeof data.countryLink !== "undefined" && data.countryLink != '') {
                    $("#localization-menu-form .dynamicCountryButton").html(data.countryLink);
                    $("#localization-menu-form .dynamicCountryButton").hide();
                    if($("#localization-menu-form .dynamicCountryButton").hasClass("js-reload-page"))
                    {
                        $("#localization-menu-form .dynamicCountryButton a.linkbtn")[0].click();
                        jQuery('#block-localizationmenublock #edit-country-form').fadeOut('slow');
                    }
                    else{
                        $("#localization-menu-form .dynamicCountryButton").show();
                    }
                } else {
                    $("#localization-menu-form .dynamicCountryButton").hide();
                }

                $("#localization-menu-form .country-change-loader").hide();
            }
        });
    }
}

;
/**
 * @file
 * Handle the form field behaviors.
 * This js is used to provide improved backend functionality
 */
(function ($) {
    Drupal.behaviors.our_stories = {
        attach: function (context, settings) {

            jQuery("body.path-node .form-type-managed-file").click(function(){
                return false;
            });
            //Field collection Layout field dependency for counter/Product module
            $(".field--name-field-counter-module-content table tr.draggable").each(function(){
                if ($(this).find(".field--name-field-module-layout select").val() == 'product') {
                    $(this).find(".field--name-field-counter-post-text").hide();
                    $(this).find(".field--name-field-counter-pre-text").hide();
                    $(this).find(".field--name-field-counter-number").hide();
                    $(this).find(".field--name-field-counter-suffix").hide();
                    $(this).find(".field--name-field-product-description").show();
                    $(this).find(".field--name-field-product-image").show();
                } else {
                    $(this).find(".field--name-field-counter-post-text").show();
                    $(this).find(".field--name-field-counter-pre-text").show();
                    $(this).find(".field--name-field-counter-number").show();
                    $(this).find(".field--name-field-counter-suffix").show();
                    $(this).find(".field--name-field-product-description").hide();
                    $(this).find(".field--name-field-product-image").hide();
                }
            });
            //Field collection Layout change field dependency for counter/Product module
            $(".field--name-field-module-layout select").on('change', function (e) {
                var newObject = $(this).closest('tr.draggable');
                var layoutSelected = $("option:selected", this);
                var layoutvalueSelected = this.value;
                if(layoutvalueSelected == "product") {
                    $(newObject).find(".field--name-field-counter-post-text").hide();
                    $(newObject).find(".field--name-field-counter-pre-text").hide();
                    $(newObject).find(".field--name-field-counter-number").hide();
                    $(newObject).find(".field--name-field-counter-suffix").hide();
                    $(newObject).find(".field--name-field-product-description").show();
                    $(newObject).find(".field--name-field-product-image").show();
                } else {
                    $(newObject).find(".field--name-field-counter-post-text").show();
                    $(newObject).find(".field--name-field-counter-pre-text").show();
                    $(newObject).find(".field--name-field-counter-number").show();
                    $(newObject).find(".field--name-field-counter-suffix").show();
                    $(newObject).find(".field--name-field-product-description").hide();
                    $(newObject).find(".field--name-field-product-image").hide();
                }
            });





            //Field collection Layout field dependency for content varition group
            $(".field--name-field-group-variations table tr.draggable").each(function(){
                if ($(this).find(".field--name-field-variation-layout select").val() == 'row') {
                    $(this).find(".field--name-field-select-right-content-varia").hide();
                    $(this).find(".field--name-field-select-left-column-variati").hide();
                    $(this).find(".field--name-field-select-row-variations").show();
                } else {
                    $(this).find(".field--name-field-select-right-content-varia").show();
                    $(this).find(".field--name-field-select-left-column-variati").show();
                    $(this).find(".field--name-field-select-row-variations").hide();
                }
            });
            //Field collection Layout change field dependency for content varition group
            $(".field--name-field-variation-layout select").on('change', function (e) {
                var newObject = $(this).closest('tr.draggable');
                var layoutSelected = $("option:selected", this);
                var layoutvalueSelected = this.value;
                if(layoutvalueSelected == "row") {
                    $(newObject).find(".field--name-field-select-right-content-varia").hide();
                    $(newObject).find(".field--name-field-select-left-column-variati").hide();
                    $(newObject).find(".field--name-field-select-row-variations").show();
                } else {
                    $(newObject).find(".field--name-field-select-right-content-varia").show();
                    $(newObject).find(".field--name-field-select-left-column-variati").show();
                    $(newObject).find(".field--name-field-select-row-variations").hide();
                }
            });


            //Flyout list creation on node edit form
            if($("form.node-form #edit-field-display-local-flyout-wrapper").length > 0) {
                var flyoutList = $("form.node-form .dynamicFlyoutList").detach();
                flyoutList.appendTo("form.node-form #edit-field-display-local-flyout-wrapper");
            }
        }
    };
})(jQuery);;
